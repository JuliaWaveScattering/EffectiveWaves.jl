<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>A numerical matching method · EffectiveWaves.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">EffectiveWaves.jl</span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../manual/introduction/">Quick introduction</a></li><li><a class="tocitem" href="../../../manual/background/">Theoretical background</a></li><li><a class="tocitem" href="../../../manual/wavenumbers/">Effective wavenumbers</a></li><li><a class="tocitem" href="../../../manual/reflection/">Reflection and transmission</a></li><li><a class="tocitem" href="../../../manual/sphere/">Scattering from a sphere</a></li><li><a class="tocitem" href="../../../manual/pair-correlation/">Pair correlation</a></li></ul></li><li><a class="tocitem" href="../../../library/library/">Library</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../vary_two_species/README/">Vary volume fraction of the two species</a></li><li><a class="tocitem" href="../../equivalent-symmetries/README/">Equivalent symmetries</a></li><li class="is-active"><a class="tocitem" href>A numerical matching method</a><ul class="internal"><li><a class="tocitem" href="#Calculate-the-effective-wavemodes"><span>Calculate the effective wavemodes</span></a></li><li><a class="tocitem" href="#Determine-the-amplitude/eignvectors-of-the-wavemodes"><span>Determine the amplitude/eignvectors of the wavemodes</span></a></li><li><a class="tocitem" href="#Calculate-the-reflection-coefficient"><span>Calculate the reflection coefficient</span></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>A numerical matching method</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>A numerical matching method</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaWaveScattering/EffectiveWaves.jl/blob/master/docs/src/examples/matched_method/README.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="A-numerical-matching-method"><a class="docs-heading-anchor" href="#A-numerical-matching-method">A numerical matching method</a><a id="A-numerical-matching-method-1"></a><a class="docs-heading-anchor-permalink" href="#A-numerical-matching-method" title="Permalink"></a></h1><p>Both of these methods calculate the ensemble average wave in a particulate material. To do so, we need to specify the geometry of the material, as this ultimately determines the fields. We choose the simplest case which is a halfspace x&gt;0 filled with particles.</p><h2 id="Calculate-the-effective-wavemodes"><a class="docs-heading-anchor" href="#Calculate-the-effective-wavemodes">Calculate the effective wavemodes</a><a id="Calculate-the-effective-wavemodes-1"></a><a class="docs-heading-anchor-permalink" href="#Calculate-the-effective-wavemodes" title="Permalink"></a></h2><pre><code class="language-julia">using EffectiveWaves

## choose a 2D acoustic medium which is highly attenuating material
    spatial_dim = 2
    medium = Acoustic(spatial_dim; ρ=1.0, c=1.0)

    # Plane wave source
    direction = [1.0,1.0]
    source = PlaneSource(medium,direction)

    # a species of circular particles
    ms = MultipleScattering # in case you load a package which has it&#39;s own definition of Circle.
    particle_medium = Acoustic(spatial_dim; ρ=0.1, c=0.1)
    specie = Specie(Particle(particle_medium, ms.Circle(0.8)); volume_fraction = 0.25)

    # a halfspace with outward normal [-1.0,0.0] and filled with specie
    material = Material(Halfspace([-1.0,0.0]), specie)

    ω = 1.0
    θin = 0.3 # angle made between incident wave direction and the material boundary

    # calculate the 4 effective waves with the smallest attenuation
    wave_effs = WaveModes(ω, source, material;
          num_wavenumbers = 5,
          θin = θin,
          extinction_rescale = false
    )

    # using Plots
    # plot(wave_effs[1:5], markeralpha = 1.0)
    # savefig(&quot;wave_effs.png&quot;)</code></pre><p><img src="../wave_effs.png" alt="Many effective wavenumbers"/></p><h2 id="Determine-the-amplitude/eignvectors-of-the-wavemodes"><a class="docs-heading-anchor" href="#Determine-the-amplitude/eignvectors-of-the-wavemodes">Determine the amplitude/eignvectors of the wavemodes</a><a id="Determine-the-amplitude/eignvectors-of-the-wavemodes-1"></a><a class="docs-heading-anchor-permalink" href="#Determine-the-amplitude/eignvectors-of-the-wavemodes" title="Permalink"></a></h2><p>To determine the amplitude of these effective waves we use the Matching method.</p><pre><code class="language-julia">    match_wave = MatchPlaneWaveMode(ω, source, material;
      θin = θin,
      wave_effs = wave_effs[1:5],
      max_size=80)

    # the error of the match is used as a proxy to determine if the method converged. That is, the match_error is the difference between a sum of the effective waves and a discrete solution.
    match_error(match_wave, material.shape) &lt; 1e-5

    # plot(match_wave, ylim = (-0.01,0.04), xlim = (2.0,10.0),
    #     xlab = &quot;x&quot;, hankel_indexes=0:1
    # )
    # savefig(&quot;match_wave.png&quot;)</code></pre><p><img src="../match_wave.png" alt="The matched wave field"/></p><p>We can compare this results against a purely numerical method, which requires a much larger mesh.</p><pre><code class="language-julia">  discrete_wave = DiscretePlaneWaveMode(ω, source, material; θin = θin, max_size=700)

  plot(discrete_wave, xlab = &quot;x&quot;, hankel_indexes=0:1)
  plot!(match_wave, seriestype=:line, xlims = (0.0,6.0),
      match_region=false, hankel_indexes=0:1
  )
  savefig(&quot;compare_match_wave.png&quot;)</code></pre><p>The two fields perfectly overlap, as the matched method is an exact method. Below the line is from the matched method, while the scatter points are from the purely numerical method. <img src="../compare_match_wave.png" alt="Compare matched and discrete field"/></p><h2 id="Calculate-the-reflection-coefficient"><a class="docs-heading-anchor" href="#Calculate-the-reflection-coefficient">Calculate the reflection coefficient</a><a id="Calculate-the-reflection-coefficient-1"></a><a class="docs-heading-anchor-permalink" href="#Calculate-the-reflection-coefficient" title="Permalink"></a></h2><pre><code class="language-julia">
R = reflection_coefficient(ω, match_wave, source, material)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../equivalent-symmetries/README/">« Equivalent symmetries</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 20 September 2022 21:46">Tuesday 20 September 2022</span>. Using Julia version 1.5.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
