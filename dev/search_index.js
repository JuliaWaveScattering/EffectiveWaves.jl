var documenterSearchIndex = {"docs":
[{"location":"examples/compare_two/README/#Code-to-generate-the-figures-below,-which-are-presented-in-the-paper-?.-The-figures-compare-different-approximations-for-the-effective-wavenumber-in-a-2D-concrete.","page":"-","title":"Code to generate the figures below, which are presented in the paper ?. The figures compare different approximations for the effective wavenumber in a 2D concrete.","text":"","category":"section"},{"location":"examples/compare_two/README/","page":"-","title":"-","text":"(Image: Compare effective wavenumber for 2D concrete) (Image: Compare effective wavenumber for 2D concrete)","category":"page"},{"location":"manual/reflection/#Reflection-and-transmission","page":"Reflection and transmission","title":"Reflection and transmission","text":"","category":"section"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"Once we have calculated the effective wavenumber, we can calculate the average reflection and transmission.","category":"page"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"Here we will use an incident plane wave","category":"page"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"u_textin = U e^i mathbf k cdot mathbf r","category":"page"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"where U is the amplitude, which is usually set to U=1 for acoustics, k = mathbf k is the incident wavenumber, and mathbf k can be a two or three dimensional vector.","category":"page"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"We will assume that u_textin is arriving from z0 (x0 for 2D). If the material occupies the region mathcal R =  z0  mathbf r in mathbb R^3, then the reflected wave will be given by  ","category":"page"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"u_textR = R e^i (k_x x + k_y y - k_z z)","category":"page"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"The code below calculates R, which is called the reflection coefficient. Both reflection and transmission are simpler to calculate when there exists only one effective wavenumber. Currently, we have only implemented the reflection coefficient for multiple effective wavenumbers for 2D acoustics.","category":"page"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"Many tests for 3D reflection and transmission are in test/acoustics-3D/planar-symmetry.jl, while tests for 2D are in the files in the folder test/acoustics-2D.  ","category":"page"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"The formulas used to calculate the below can mostly be found in Gower & Kristensson 2020 and Gower et al. 2018","category":"page"},{"location":"manual/reflection/#two-dim-acoustics-reflection","page":"Reflection and transmission","title":"2D acoustics","text":"","category":"section"},{"location":"manual/reflection/#two-dim-acoustic-low-reflection","page":"Reflection and transmission","title":"Low frequency reflection","text":"","category":"section"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"The simplest case is for low frequency, where the average reflection coefficient R reduces to the reflection coefficient from a homogeneous material:","category":"page"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"R = fracq_* cos theta_textin - cos theta_*q_* cos theta_textin + cos theta_*","category":"page"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"where","category":"page"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"mathcal R =  x0  mathbf r in mathbb R^2   textand  mathbf k = k (cos theta_textin sin theta_textin)","category":"page"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"In code this becomes","category":"page"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"spatial_dim = 2\nmedium = Acoustic(spatial_dim; ρ=1.2, c=1.5)\n\n# Choose the species\nradius1 = 0.1\ns1 = Specie(\n    Acoustic(spatial_dim; ρ=10.2, c=10.1), radius1;\n    volume_fraction=0.2\n);\nradius2 = 0.2\ns2 = Specie(\n    Acoustic(spatial_dim; ρ=0.2, c=4.1), radius2;\n    volume_fraction=0.15\n\n);\nspecies = [s1,s2]\n\n# Choose the frequency\nω = 1e-4\nk = ω / medium.c\n\n# Calculate the equivalent effective medium in the asymptotic low frequency limit\neff_medium = effective_medium(medium, species)\n\nnormal = [-1.0,0.0] # an outward normal to the surface\n\n# Define the material region\nmaterial = Material(Halfspace(normal),species)\n\n# define a plane wave source travelling at a 45 degree angle in relation to the material\nsource = PlaneSource(medium, [cos(pi/4.0),sin(pi/4.0)])\n\nR = reflection_coefficient(ω,source, eff_medium, material.shape);\n\nround(R * 100) / 100\n# output\n\n0.14 + 0.0im","category":"page"},{"location":"manual/reflection/#two-dim-acoustics-one_reflection","page":"Reflection and transmission","title":"One plane wave mode","text":"","category":"section"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"Note there are formulas for low volume fraction expansions of the reflection coefficient, see reflection_coefficient_low_volumefraction. However, it is better to use the exact expression, as the different in computational cost is minimal.  ","category":"page"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"As an example, we will use the same material defined for the low frequency case","category":"page"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"\nk_effs = wavenumbers(ω, medium, species; tol = 1e-6, num_wavenumbers = 1, basis_order = 1)\n\n# Calculate the wavemode for the first wavenumber\nwave1 = WaveMode(ω, k_effs[1], source, material; tol = 1e-6, basis_order = 1)\n\nR = reflection_coefficient(ω, wave1, source, material)\n\nround(R * 100) / 100\n\n# output\n0.14 + 0.0im","category":"page"},{"location":"manual/reflection/#two-dim-acoustic-multiple-reflection","page":"Reflection and transmission","title":"Multiple effective modes","text":"","category":"section"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"See A numerical matching method for an example that uses multiple effective wave modes to calculate the reflection coefficient.","category":"page"},{"location":"manual/reflection/#D-acoustics","page":"Reflection and transmission","title":"3D acoustics","text":"","category":"section"},{"location":"manual/reflection/#Low-frequency-reflection","page":"Reflection and transmission","title":"Low frequency reflection","text":"","category":"section"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"The simplest case is for low frequency, where the average reflection coefficient R reduces to the reflection coefficient from a homogeneous material:","category":"page"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"R = fracq_* cos theta_textin - cos theta_*q_* cos theta_textin + cos theta_*","category":"page"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"where","category":"page"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"mathcal R =  z0  mathbf r in mathbb R^3  textand  mathbf k = k (cos phi_textin sin theta_textin sin phi_textin sin theta_textin cos theta_textin)","category":"page"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"In code this becomes","category":"page"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"\nspatial_dim = 3\nmedium = Acoustic(spatial_dim; ρ=0.3, c=0.5)\n\n# Choose the species\nradius1 = 0.1\ns1 = Specie(\n    Acoustic(spatial_dim; ρ=10.2, c=10.1), radius1;\n    volume_fraction=0.2\n);\nspecies = [s1]\n\n# Choose the frequency\nω = 1e-5\nk = ω / medium.c\n\n# For the limit of low frequencies we can define\neff_medium = effective_medium(medium, species)\n\n# Define a plate\nr = maximum(outer_radius.(species))\nnormal = [0.0,0.0,-1.0] # an outward normal to both surfaces of the\nwidth = 150.0 # plate width\norigin = [0.0,0.0,width/2] # the centre of the plate\n\n\n# the size of the effective low frequency limit material is one particle radius smaller\nplate_low = Plate(normal,width - 2r,origin)\nhalfspace_low = Halfspace(normal,[0.0,0.0,r])\n\n# define a plane wave source travelling at a 45 degree angle in relation to the material\nsource = PlaneSource(medium, [cos(pi/4.0),0.0,sin(pi/4.0)])\n\nRamp1 = reflection_coefficient(ω, source, eff_medium, halfspace_low)\n\n# planewave_amplitudes returns the\namps = planewave_amplitudes(ω, source, eff_medium, plate_low)\nRamp = amps[1]\nTamp = amps[2]\n\nround(1000 * Tamp) / 1000\n\n# output\n\n1.0 + 0.002im","category":"page"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"The function planewave_amplitudes returns [R, T, P1, P2] where R is the reflection coefficient, T is the coefficient of the transmitted wave, and P1 (P2) are the amplitudes of the wave travling forward (backward) inside the plate.","category":"page"},{"location":"manual/reflection/#three-dim-acoustic-one-reflection","page":"Reflection and transmission","title":"One plane wave mode ","text":"","category":"section"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"Using only one plane wave mode we can calculate both reflection and transmission from a plate.","category":"page"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"k_effs = wavenumbers(ω, medium, species;\n    tol = 1e-6,\n    num_wavenumbers = 1,\n    basis_order = 1\n)\nk_eff = k_effs[1]\n\nabs(k_eff - ω / eff_medium.c) < 1e-10\n\nhalfspace = Halfspace(normal)\nplate = Plate(normal,width,origin)\n\nmaterial = Material(halfspace,species)\n\n# Calculate the wavemode for the first wavenumber\n# the WaveMode function calculates the types of waves and solves the needed boundary conditions\nwavemode = WaveMode(ω, k_eff, source, material; tol = 1e-6, basis_order = 1);\n\nReff = reflection_coefficient(wavemode, source, material)\n\nmaterial = Material(plate,species)\nwavemodes = WaveMode(ω, k_eff, source, material; tol = 1e-6, basis_order = 1);\nRTeff = reflection_transmission_coefficients(wavemodes, source, material);\n\nabs(Ramp1 - Reff) < 1e-6\n\nabs.(RTeff - [Ramp; Tamp]) .< [1e-4, 5e-4]\n\n# Note that summing the reflection and transmission from the homogeneous low frequency medium gives 1\nsum(abs.([Ramp,Tamp]).^2) ≈ 1.0\nsum(abs.(RTeff).^2)","category":"page"},{"location":"manual/reflection/","page":"Reflection and transmission","title":"Reflection and transmission","text":"Formulas from Gower & Kristensson 2020.","category":"page"},{"location":"examples/matched_method/README/#A-numerical-matching-method","page":"A numerical matching method","title":"A numerical matching method","text":"","category":"section"},{"location":"examples/matched_method/README/","page":"A numerical matching method","title":"A numerical matching method","text":"Both of these methods calculate the ensemble average wave in a particulate material. To do so, we need to specify the geometry of the material, as this ultimately determines the fields. We choose the simplest case which is a halfspace x>0 filled with particles.","category":"page"},{"location":"examples/matched_method/README/#Calculate-the-effective-wavemodes","page":"A numerical matching method","title":"Calculate the effective wavemodes","text":"","category":"section"},{"location":"examples/matched_method/README/","page":"A numerical matching method","title":"A numerical matching method","text":"using EffectiveWaves\n\n## choose a 2D acoustic medium which is highly attenuating material\n    spatial_dim = 2\n    medium = Acoustic(spatial_dim; ρ=1.0, c=1.0)\n\n    # Plane wave source\n    direction = [1.0,1.0]\n    source = PlaneSource(medium,direction)\n\n    # a species of circular particles\n    ms = MultipleScattering # in case you load a package which has it's own definition of Circle.\n    particle_medium = Acoustic(spatial_dim; ρ=0.1, c=0.1)\n    specie = Specie(Particle(particle_medium, ms.Circle(0.8)); volume_fraction = 0.25)\n\n    # a halfspace with outward normal [-1.0,0.0] and filled with specie\n    material = Material(Halfspace([-1.0,0.0]), specie)\n\n    ω = 1.0\n    θin = 0.3 # angle made between incident wave direction and the material boundary\n\n    # calculate the 4 effective waves with the smallest attenuation\n    wave_effs = WaveModes(ω, source, material;\n          num_wavenumbers = 5,\n          θin = θin,\n          extinction_rescale = false\n    )\n\n    # using Plots\n    # plot(wave_effs[1:5], markeralpha = 1.0)\n    # savefig(\"wave_effs.png\")","category":"page"},{"location":"examples/matched_method/README/","page":"A numerical matching method","title":"A numerical matching method","text":"(Image: Many effective wavenumbers)","category":"page"},{"location":"examples/matched_method/README/#Determine-the-amplitude/eignvectors-of-the-wavemodes","page":"A numerical matching method","title":"Determine the amplitude/eignvectors of the wavemodes","text":"","category":"section"},{"location":"examples/matched_method/README/","page":"A numerical matching method","title":"A numerical matching method","text":"To determine the amplitude of these effective waves we use the Matching method.","category":"page"},{"location":"examples/matched_method/README/","page":"A numerical matching method","title":"A numerical matching method","text":"    match_wave = MatchPlaneWaveMode(ω, source, material;\n      θin = θin,\n      wave_effs = wave_effs[1:5],\n      max_size=80)\n\n    # the error of the match is used as a proxy to determine if the method converged. That is, the match_error is the difference between a sum of the effective waves and a discrete solution.\n    match_error(match_wave, material.shape) < 1e-5\n\n    # plot(match_wave, ylim = (-0.01,0.04), xlim = (2.0,10.0),\n    #     xlab = \"x\", hankel_indexes=0:1\n    # )\n    # savefig(\"match_wave.png\")","category":"page"},{"location":"examples/matched_method/README/","page":"A numerical matching method","title":"A numerical matching method","text":"(Image: The matched wave field)","category":"page"},{"location":"examples/matched_method/README/","page":"A numerical matching method","title":"A numerical matching method","text":"We can compare this results against a purely numerical method, which requires a much larger mesh.","category":"page"},{"location":"examples/matched_method/README/","page":"A numerical matching method","title":"A numerical matching method","text":"  discrete_wave = DiscretePlaneWaveMode(ω, source, material; θin = θin, max_size=700)\n\n  plot(discrete_wave, xlab = \"x\", hankel_indexes=0:1)\n  plot!(match_wave, seriestype=:line, xlims = (0.0,6.0),\n      match_region=false, hankel_indexes=0:1\n  )\n  savefig(\"compare_match_wave.png\")","category":"page"},{"location":"examples/matched_method/README/","page":"A numerical matching method","title":"A numerical matching method","text":"The two fields perfectly overlap, as the matched method is an exact method. Below the line is from the matched method, while the scatter points are from the purely numerical method. (Image: Compare matched and discrete field)","category":"page"},{"location":"examples/matched_method/README/#Calculate-the-reflection-coefficient","page":"A numerical matching method","title":"Calculate the reflection coefficient","text":"","category":"section"},{"location":"examples/matched_method/README/","page":"A numerical matching method","title":"A numerical matching method","text":"\nR = reflection_coefficient(ω, match_wave, source, material)","category":"page"},{"location":"examples/emulsion/README/#Code-to-generate-the-figures-below,-which-compare-different-approximations-for-the-effective-wavenumber-in-a-2D-emulsion.-If-you-are-new-to-Julia,-please-open-the-ipynb-files-above,-which-show-how-to-run-the-code-in-your-browser-on-[JuliaBox](https://www.juliabox.com/).","page":"-","title":"Code to generate the figures below, which compare different approximations for the effective wavenumber in a 2D emulsion. If you are new to Julia, please open the ipynb files above, which show how to run the code in your browser on JuliaBox.","text":"","category":"section"},{"location":"examples/emulsion/README/","page":"-","title":"-","text":"Code: fluid_species.ipynb (Image: Compare effective wavenumber for 2D emulsion) (Image: Compare effective wavenumber for 2D emulsion)","category":"page"},{"location":"examples/emulsion/README/","page":"-","title":"-","text":"Code: fluidspecieslarge-freq.ipynb (Image: Compare effective wavenumber for 2D emulsion)","category":"page"},{"location":"examples/emulsion/README/","page":"-","title":"-","text":"Code: fluidspeciesvolfrac.ipynb (Image: Compare effective wavenumber for 2D emulsion)","category":"page"},{"location":"manual/introduction/#Quick-introduction","page":"Quick introduction","title":"Quick introduction","text":"","category":"section"},{"location":"manual/introduction/","page":"Quick introduction","title":"Quick introduction","text":"How do you take a reliable measurement of a material whose microstructure is random? For example, the microstructure may have randomly placed particles. When using wave scattering or spectroscopy, each measurement can lead to a different outcome. Lots of example are shown in the package MultipleScattering.jl.","category":"page"},{"location":"manual/introduction/","page":"Quick introduction","title":"Quick introduction","text":"To obtain a repeatable measurement we can take an average of several measurements (average over time or space). This is the same as taking an ensemble average over all possible arrangements of the microstructure. This package calculates the ensemble average of scattering and transmission fields for acoustics, and potentially elastic waves and electromagnetic waves. For an overview of the mathematics, see Theoretical background.","category":"page"},{"location":"manual/introduction/","page":"Quick introduction","title":"Quick introduction","text":"This package calculates the average scattered and transmitted wave for a number of scenarios, including: in a plate, a sphere, and a halfspace (links needed). In all these scenarios, the first step is to calculate the effective wavenumbers.","category":"page"},{"location":"manual/introduction/","page":"Quick introduction","title":"Quick introduction","text":"Below we calculate the effective wavenumbers for water and some gas (two species) randomly distributed in Glycerol. We use only low volume fraction methods for simplicity.","category":"page"},{"location":"manual/introduction/#Define-the-material","page":"Quick introduction","title":"Define the material","text":"","category":"section"},{"location":"manual/introduction/","page":"Quick introduction","title":"Quick introduction","text":"using EffectiveWaves\n# where: ρ = density, r = radius, c = wavespeed, and volfrac = volume fraction\n\nspatial_dimension = 3 # for 3D material\n\n# we use the type Acoustic when we only want to consider pressure waves\nglycerol = Acoustic(spatial_dimension; ρ = 1.26*1000,  c = 1904.0)\n\nwater_distilled = Acoustic(spatial_dimension; ρ = 0.998*1000, c = 1496.0)\nwater_radius = 30e-6\n\ngas = Acoustic(spatial_dimension; ρ = 1.0, c = 1.0)\ngas_radius = 1e-6\n\n# by supplying only a radius we are assuming the particles are spheres, although other particle shapes are allowed.\nspecies = [\n    Specie(water_distilled, water_radius; volume_fraction = 0.1)\n    Specie(gas, gas_radius; volume_fraction = 0.01)\n]\n\n# background medium\nbackground = glycerol","category":"page"},{"location":"manual/introduction/","page":"Quick introduction","title":"Quick introduction","text":"For a list of other materials go to ../examples/materials.jl.","category":"page"},{"location":"manual/introduction/#Calculate-effective-wavenumbers:","page":"Quick introduction","title":"Calculate effective wavenumbers:","text":"","category":"section"},{"location":"manual/introduction/","page":"Quick introduction","title":"Quick introduction","text":"# angular frequencies\nωs = LinRange(0.01,1.0,60)*30.0e6\nks = wavenumber_low_volumefraction(ωs, background, species)\n\nspeeds = ωs ./ real.(ks)\nattenuations = imag.(ks)","category":"page"},{"location":"manual/introduction/#Plot-the-results","page":"Quick introduction","title":"Plot the results","text":"","category":"section"},{"location":"manual/introduction/","page":"Quick introduction","title":"Quick introduction","text":"using Plots\npyplot(linewidth=2.0)\n\np1 = scatter(ωs, speeds, lab = \"\", ylabel = \"wave speed (m/s)\", xlabel = \"frequency\");\np2 = scatter(ωs, attenuations, lab = \"\", ylabel = \"attenuation (1/m)\", xlabel = \"frequency\");\nplot(p1,p2, layout = (2,1))","category":"page"},{"location":"manual/introduction/","page":"Quick introduction","title":"Quick introduction","text":"(Image: ../speed_and_atten.png)","category":"page"},{"location":"manual/background/#Theoretical-background","page":"Theoretical background","title":"Theoretical background","text":"","category":"section"},{"location":"manual/background/","page":"Theoretical background","title":"Theoretical background","text":"Assume that u(x) represents some field governed by a Helmholtz equation, such as a pressure field for acoustics. If u(x) is the transmitted field through a material filled with randomly placed particles, or inhomogeneities, then u(x) will be depend on the exact positions and types of particles. This makes u(x) difficult to calculate and to experimentally measure exactly. For these reasons we focus on calculating the ensemble average langle u(x)rangle over all possible configurations of the inhomogeneities.","category":"page"},{"location":"manual/background/","page":"Theoretical background","title":"Theoretical background","text":"This ensemble average can be written in a series of the form","category":"page"},{"location":"manual/background/","page":"Theoretical background","title":"Theoretical background","text":"langle u(x) rangle = sum_p phi_p(x)","category":"page"},{"location":"manual/background/","page":"Theoretical background","title":"Theoretical background","text":"where each phi_p satisfies a Helmholtz equation nabla^2 phi_p(x) + k_p phi_p(x) = 0. The k_p are the effective wavenumbers, and the phi_p depend on the geometry of the problem. We refer to each phi_p as a wavemode. For details see Gower & Kristensson 2020.","category":"page"},{"location":"manual/background/","page":"Theoretical background","title":"Theoretical background","text":"An important consequence of the theory, is that the wavenumbers k_p depend only on the statistics and microstructure of the material. The k_p do not depend on the shape of the material or the specific form of phi_p. We give an example of this in Equivalent symmetries.","category":"page"},{"location":"manual/background/#Plane-waves","page":"Theoretical background","title":"Plane waves","text":"","category":"section"},{"location":"manual/background/","page":"Theoretical background","title":"Theoretical background","text":"The simplest case is when using an incident plane wave and material in the shape of a plate or halfspace. This combination is an example of plannar symmetry (see PlanarSymmetry). In this case, phi_p has to be a plane wave. We use this case to calculate the k_p, as the wavenumbers are the same for every symmetry.","category":"page"},{"location":"manual/background/","page":"Theoretical background","title":"Theoretical background","text":"In more detail, the package actually solves for the average scattering coefficient langle f_nrangle (mathbf r_1), of order n and for a particle centred at mathbf r_1, which is then used to calculate the  average field langle u(x) rangle.   ","category":"page"},{"location":"manual/background/","page":"Theoretical background","title":"Theoretical background","text":"For planar symmetry, the langle f_nrangle also have to be plane waves, which allows us to  represent","category":"page"},{"location":"manual/background/","page":"Theoretical background","title":"Theoretical background","text":"langle f_nrangle (mathbf r_1) = sum_p F_pn mathrm e^i mathbf k_p cdot mathbf r_1","category":"page"},{"location":"manual/background/","page":"Theoretical background","title":"Theoretical background","text":"We refer to the F_pn as the plane wave eigenvector of the wavenumber k_p = mathbf k_p .","category":"page"},{"location":"examples/concrete/README/#Code-to-generate-the-figures-below,-which-compare-different-approximations-for-the-effective-wavenumber-in-a-2D-concrete.-If-you-are-new-to-Julia,-please-open-the-ipynb-files-above,-which-show-how-to-run-the-code-in-your-browser-on-[JuliaBox](https://www.juliabox.com/).","page":"-","title":"Code to generate the figures below, which compare different approximations for the effective wavenumber in a 2D concrete. If you are new to Julia, please open the ipynb files above, which show how to run the code in your browser on JuliaBox.","text":"","category":"section"},{"location":"examples/concrete/README/","page":"-","title":"-","text":"Code: concrete_species.ipynb (Image: Compare effective wavenumber for 2D concrete) (Image: Compare effective wavenumber for 2D concrete)","category":"page"},{"location":"examples/concrete/README/","page":"-","title":"-","text":"Code: concretespecies-largefreq.ipynb (Image: Compare effective wavenumber for 2D concrete)","category":"page"},{"location":"examples/concrete/README/","page":"-","title":"-","text":"Code: concretespeciesvolfrac.ipynb (Image: Compare effective wavenumber for 2D concrete)","category":"page"},{"location":"manual/sphere/#Scattering-from-a-sphere","page":"Scattering from a sphere","title":"Scattering from a sphere","text":"","category":"section"},{"location":"manual/sphere/","page":"Scattering from a sphere","title":"Scattering from a sphere","text":"Here we show how to calculate the average acoustic wave scattered from a sphere filled with particles. We will the analytic solution with an approximation using effective low frequency properties.","category":"page"},{"location":"manual/sphere/#Choose-the-microstructure","page":"Scattering from a sphere","title":"Choose the microstructure","text":"","category":"section"},{"location":"manual/sphere/","page":"Scattering from a sphere","title":"Scattering from a sphere","text":"using EffectiveWaves, LinearAlgebra\n\nspatial_dim = 3\nmedium = Acoustic(spatial_dim; ρ=1.0, c=1.0)\n\ns1 = Specie(\n    Acoustic(spatial_dim; ρ=10.0, c=10.0), Sphere(spatial_dim, 1.0);\n    volume_fraction=0.15\n);\ns2 = Specie(\n    Acoustic(spatial_dim; ρ=0.22, c=0.22), Sphere(spatial_dim, 1.0);\n    volume_fraction=0.05\n);\nspecies = [s1,s2]\n\n# calculate the low frequency effective properties\neff_medium = effective_medium(medium, species)\n\n# choose incident angular frequency\nω = 0.22\n\n# choose maximum order of the spherical harmonic for scattered waves from particles\nbasis_order = 2\n\n# choose a numerical tolerance\ntol = 1e-7\n\n# calculate the effective wavenumbers which are valid for any frequency low frequency effective properties\nopts = Dict(\n    :num_wavenumbers => 2, # calculate at least 3 wavenumbers\n    :basis_order => basis_order,\n    :tol => tol\n)\n\n# note this is the heaviest calculation in this example\nk_effs = wavenumbers(ω, medium, species; opts...)","category":"page"},{"location":"manual/sphere/#Is-one-effective-wavenumber-enough?","page":"Scattering from a sphere","title":"Is one effective wavenumber enough?","text":"","category":"section"},{"location":"manual/sphere/","page":"Scattering from a sphere","title":"Scattering from a sphere","text":"To easily calculate scattered waves we need k_effs[1] to have a smaller imaginary part than the other wavenumbers k_effs[2:end]. This is easily checked with a scatter plot","category":"page"},{"location":"manual/sphere/","page":"Scattering from a sphere","title":"Scattering from a sphere","text":"using Plots\npyplot(size = (600, 350))\n\nscatter(k_effs, lab = \"kp\", ylims = (0.0,Inf))  \n# savefig(\"../assets/sphere-wavenumbers.png\")","category":"page"},{"location":"manual/sphere/","page":"Scattering from a sphere","title":"Scattering from a sphere","text":"(Image: sphere-wavenumbers.png)","category":"page"},{"location":"manual/sphere/","page":"Scattering from a sphere","title":"Scattering from a sphere","text":"When using only one wavenumber, and excluding the other wavenumber, will lead to an error that is roughly given by","category":"page"},{"location":"manual/sphere/","page":"Scattering from a sphere","title":"Scattering from a sphere","text":"λ = 2π * medium.c / ω\napproximate_error = abs(exp(im * λ * k_effs[2]) / exp(im * λ * k_effs[1]))\n\n# output\n\n1.5188e-6 # approximately","category":"page"},{"location":"manual/sphere/","page":"Scattering from a sphere","title":"Scattering from a sphere","text":"The precise error depends on the application.","category":"page"},{"location":"manual/sphere/#Define-the-source-and-material","page":"Scattering from a sphere","title":"Define the source and material","text":"","category":"section"},{"location":"manual/sphere/","page":"Scattering from a sphere","title":"Scattering from a sphere","text":"As we want to calculate effective scattered waves, and not just effective wavenumbers, we need to define a source and material domain. We will choose a plane-wave source, and a sphere for the domain.  ","category":"page"},{"location":"manual/sphere/","page":"Scattering from a sphere","title":"Scattering from a sphere","text":"# choose an incident wave\n# NOTE: having the incident wave direction along the z-axis leads to azimuthal symmetry, which simplifies the next steps.\nθ = 0.0\npsource = PlaneSource(medium, [sin(θ),0.0,cos(θ)]);\n\n# choose the size and position of the spherical domain of the material\nR = 20.0\nmaterial = Material(Sphere(spatial_dim, R),species);\n\n# the larger the material region, the larger this basis_field_order needs to be\nbasis_field_order = 7","category":"page"},{"location":"manual/sphere/#Calculate-the-scattered-waves","page":"Scattering from a sphere","title":"Calculate the scattered waves","text":"","category":"section"},{"location":"manual/sphere/","page":"Scattering from a sphere","title":"Scattering from a sphere","text":"Below we calculate the outward going spherical wave coefficients. These coefficients, multiplied with a basis of outward going waves, will give the scattered field.","category":"page"},{"location":"manual/sphere/","page":"Scattering from a sphere","title":"Scattering from a sphere","text":"# create a sphere using the low frequency effective properties\neffective_sphere = Particle(eff_medium, material.shape)\n\nregion_order = basis_order + basis_field_order\n\n# calculate the T-matrix, also know as scattering matrix, and take the diagonal\nt_mat = t_mat(effective_sphere, medium, ω, region_order);\n\n# calculate the outward going spherical wave coefficients\nsource_coefficients = regular_spherical_coefficients(psource)(region_order,zeros(3),ω);\nscat_low_coefficients = t_mat * source_coefficients\n\n# for the analytic solution, we need the wavemode first\nwave = WaveMode(ω, k_effs[1], psource, material;\n        tol=tol,\n        basis_order = basis_order,\n        basis_field_order = basis_field_order\n)\n\n# and then the outward spherical wave coefficients\nscat_coefficients = material_scattering_coefficients(wave)","category":"page"},{"location":"manual/sphere/#Calculate-the-field","page":"Scattering from a sphere","title":"Calculate the field","text":"","category":"section"},{"location":"manual/sphere/","page":"Scattering from a sphere","title":"Scattering from a sphere","text":"xlim = 3.0 * R\nylim = 4.4 * R\n\n# a region to plot\nregion = Box([[-xlim,-ylim], [xlim,ylim]]);\n\n# a quick fix to make it a 3D region\nxs, xinds = points_in_shape(region; res = 180);\nxs = [[x[1],0,x[2]] for x in xs];\n\n# Calculate the field for the low frequency effective properties\nparticles = [Particle(eff_medium,material.shape)]\nsim = FrequencySimulation(particles, psource)\nfs = field(sim, ω, xs[xinds], scat_low_coefficients);\n\nfield_mat = zeros(typeof(fs[1]), length(xs), 1);\nfield_mat[xinds,:] = fs;\nresult_low = FrequencySimulationResult(field_mat, xs, [ω])\n\n\n# Calculate the analytic scattered field\nfs = field(sim, ω, xs[xinds], scat_coefficients);\n\nfield_mat = zeros(typeof(fs[1]), length(xs), 1);\nfield_mat[xinds,:] = fs;\nresult = FrequencySimulationResult(field_mat, xs, [ω])","category":"page"},{"location":"manual/sphere/#Plot-the-field","page":"Scattering from a sphere","title":"Plot the field","text":"","category":"section"},{"location":"manual/sphere/","page":"Scattering from a sphere","title":"Scattering from a sphere","text":"\npyplot( frame = :axes,\n    size = (xlim * 5.0, ylim * 4.0),\n    flip = false,\n    xlims = :auto, ylims = :auto,\n    title=\"\", xlab=\"ka\",ylab=\"y\"\n)\n\nplot(result_low, ω, seriestype = :contour, field_apply=abs\n, color = :balance # for julia 1.1 change to color = :pu_or\n, levels = 16, clims=(0.0,1.65)\n, title = \"abs low freq. scat\"\n, axis=false)\nplot!(material.shape)\np_scat = plot!(leg = false, frame = :none\n,axis=false, xlab=\"\",ylab=\"\")\n\n# savefig(\"../assets/low-freq-scat-sphere.png\")","category":"page"},{"location":"manual/sphere/","page":"Scattering from a sphere","title":"Scattering from a sphere","text":"(Image: low-freq-scat-sphere.png)","category":"page"},{"location":"manual/sphere/","page":"Scattering from a sphere","title":"Scattering from a sphere","text":"plot(result,ω, seriestype = :contour, field_apply=abs\n, levels = 16, clims=(0.0,1.65)\n, title = \"abs scattered field\"\n, color = :balance\n, colorbar = false\n)\nplot!(material.shape)\nplot!(leg = false\n, axis=false, xlab=\"\",ylab=\"\")\n\n# savefig(\"../assets/scat-sphere.png\")","category":"page"},{"location":"manual/sphere/","page":"Scattering from a sphere","title":"Scattering from a sphere","text":"(Image: scat-sphere.png)","category":"page"},{"location":"manual/sphere/#Plot-a-gif","page":"Scattering from a sphere","title":"Plot a gif","text":"","category":"section"},{"location":"manual/sphere/","page":"Scattering from a sphere","title":"Scattering from a sphere","text":"Finally, for fun, we plot a GIF of the real part of the full field.","category":"page"},{"location":"manual/sphere/","page":"Scattering from a sphere","title":"Scattering from a sphere","text":"max_c = maximum(abs.(field(result)))\nmin_c = - max_c\n\nts = LinRange(0.,2pi/ω,30)\n\nanim = @animate for t in ts\n    plot(result, ω, seriestype=:contour\n        , levels = 20\n        , phase_time=t\n        , leg = false\n        , field_apply = real\n        , clim = (min_c, max_c)\n        , colorbar = false\n        , color = :balance\n        , frame = :none\n        , title = \"Re. full field\"\n    )\n    plot!(material.shape)\n    plot!(leg = false, frame = :none\n    , axis=false, xlab=\"\",ylab=\"\")\n\nend\n# gif(anim,\"../assets/real-sphere-scatter.gif\", fps = 7)\n\nanim = @animate for t in ts\n    plot(result_low, ω, seriestype=:contour\n        , levels = 20\n        , phase_time=t\n        , leg = false\n        , field_apply = real\n        , clim = (min_c, max_c)\n        , colorbar = false\n        , color = :balance\n        , frame = :none\n        , title = \"Re. low freq full field\"\n    )\n    plot!(material.shape)\n    plot!(leg = false, frame = :none\n    , axis=false, xlab=\"\",ylab=\"\")\n\nend\n# gif(anim,\"../assets/real-sphere-low-scat-scatter.gif\", fps = 7)\n","category":"page"},{"location":"manual/sphere/","page":"Scattering from a sphere","title":"Scattering from a sphere","text":"(Image: real-sphere-scatter.gif) (Image: real-sphere-low-scat-scatter.gif)","category":"page"},{"location":"examples/equivalent-symmetries/README/#Equivalent-symmetries","page":"Equivalent symmetries","title":"Equivalent symmetries","text":"","category":"section"},{"location":"examples/equivalent-symmetries/README/","page":"Equivalent symmetries","title":"Equivalent symmetries","text":"Here we show how to formulate dispersion equations for wave mode which are not just plane waves. See Theoretical background for an overview.","category":"page"},{"location":"examples/equivalent-symmetries/README/","page":"Equivalent symmetries","title":"Equivalent symmetries","text":"The dispersion equations become simpler the more symmetries that are shared between the incident wave and the material geometry. The simplest case is PlanarAzimuthalSymmetry, and includes the case where a plane wave is directly incident upon a flat surface. If no symmetries are present, then the type WithoutSymmetry is used and leads to a general dispersion equation for materials which occupy a simple connected domain. This general dispersion equation has spurious roots and is computationally heavier to solve, see Gower & Kristensson 2020.  ","category":"page"},{"location":"examples/equivalent-symmetries/README/#Choose-the-microstructure","page":"Equivalent symmetries","title":"Choose the microstructure","text":"","category":"section"},{"location":"examples/equivalent-symmetries/README/","page":"Equivalent symmetries","title":"Equivalent symmetries","text":"spatial_dim = 3\nmedium = Acoustic(spatial_dim; ρ=1.2, c=1.5)\n\n# Below we explicitly define the shape of the particles as being spheres\ns1 = Specie(\n    Acoustic(spatial_dim; ρ=1.0, c=0.5), Sphere(spatial_dim, 0.4);\n    volume_fraction=0.2\n);\n\n# We use just one specie to speed up the calculations.\nspecies = [s1]","category":"page"},{"location":"examples/equivalent-symmetries/README/#Calculate-the-wavenumbers","page":"Equivalent symmetries","title":"Calculate the wavenumbers","text":"","category":"section"},{"location":"examples/equivalent-symmetries/README/","page":"Equivalent symmetries","title":"Equivalent symmetries","text":"ω = 0.9\ntol = 1e-7\n\n# Calculate the wavenumbers for PlanarAzimuthalSymmetry()\nAP_kps = wavenumbers(ω, medium, species;\n    num_wavenumbers = 4, tol = tol,\n    symmetry = PlanarAzimuthalSymmetry())\n\n# Calculate the wavenumbers for just PlanarSymmetry()\nP_kps = wavenumbers(ω, medium, species;\n    num_wavenumbers = 4, tol = tol,\n    symmetry = PlanarSymmetry{3}())\n\n# Select a subset to test. The dispersion equation WithoutSymmetry can be unstable for higher order effective wavenumbers.\nAP_kps = AP_kps[1:min(length(AP_kps),14)]\nP_kps = P_kps[1:min(length(P_kps),14)]","category":"page"},{"location":"examples/equivalent-symmetries/README/#Test-different-dispersion-equations","page":"Equivalent symmetries","title":"Test different dispersion equations","text":"","category":"section"},{"location":"examples/equivalent-symmetries/README/","page":"Equivalent symmetries","title":"Equivalent symmetries","text":"AP_det = dispersion_equation(ω, medium, species, PlanarAzimuthalSymmetry{spatial_dim}())\nP_det = dispersion_equation(ω, medium, species, PlanarSymmetry{spatial_dim}())\nAR_det = dispersion_equation(ω, medium, species, AzimuthalSymmetry{spatial_dim}())\nR_det = dispersion_equation(ω, medium, species, WithoutSymmetry{spatial_dim}())\n\n# As plane waves with azimuthal symmetry is a sub-case of plane-waves, and all materials allow for the effective wavenumbers of plane waves, all the below determinant equations should be satisfied\nmaximum(AP_det.(AP_kps)) < tol\nmaximum(P_det.(AP_kps)) < tol\nmaximum(AR_det.(AP_kps)) < tol^2\nmaximum(R_det.(AP_kps)) < tol^3\n\n# However, there do exist effective wavenumbers for plane-waves which have eigen-vectors that do not satisfy azimuthal symmetry. This is why maximum(AP_det.(P_kps)) != 0.0\n\nmaximum(AP_det.(P_kps)) > tol\nmaximum(P_det.(P_kps)) < tol\nmaximum(AR_det.(P_kps)) < tol^2\nmaximum(R_det.(P_kps)) < tol^3","category":"page"},{"location":"examples/README/#[demo.jl](vary_two_species/README.md)","page":"-","title":"demo.jl","text":"","category":"section"},{"location":"examples/README/","page":"-","title":"-","text":"Shows how to choose two species, vary the volume fraction of them both, and plot the resulting sound speed and attenuation.","category":"page"},{"location":"examples/README/#[Demonstrate-the-matching-method](matched_method/README.md)","page":"-","title":"Demonstrate the matching method","text":"","category":"section"},{"location":"examples/README/","page":"-","title":"-","text":"Compare the matched method with a purely numerical scheme. Both of these methods calculate the ensemble average wave in a particulate material.","category":"page"},{"location":"manual/pair-correlation/#Pair-correlation","page":"Pair correlation","title":"Pair correlation","text":"","category":"section"},{"location":"manual/pair-correlation/","page":"Pair correlation","title":"Pair correlation","text":"In the previous example there was no mention on how the particles are distributed. This can be specified by choosing a pair correlation, and when no pair correlation is specified, the default is to assume that particles are uncorrelated, except they can not overlap.","category":"page"},{"location":"manual/pair-correlation/","page":"Pair correlation","title":"Pair correlation","text":"Choosing the particle distribution only affects the effective wavenumbers and wavemodes, see references [1,2]","category":"page"},{"location":"manual/pair-correlation/#Percus-Yevick","page":"Pair correlation","title":"Percus-Yevick","text":"","category":"section"},{"location":"manual/pair-correlation/","page":"Pair correlation","title":"Pair correlation","text":"Let us consider a material filled with only one type of particle","category":"page"},{"location":"manual/pair-correlation/","page":"Pair correlation","title":"Pair correlation","text":"medium = Acoustic(3; ρ=1.2, c=1.0)\n\n# Choose the species\nr = 0.5\ns = Specie(\n    Acoustic(3; ρ = 0.01, c = 0.01),\n    #Acoustic(3; ρ = 0.1, c = 0.1),\n    Sphere(r),\n    volume_fraction = 0.3,\n    exclusion_distance = 1.01\n);","category":"page"},{"location":"manual/pair-correlation/","page":"Pair correlation","title":"Pair correlation","text":"Next we create a microstructure that has only this species, and has a specific pair-correlation","category":"page"},{"location":"manual/pair-correlation/","page":"Pair correlation","title":"Pair correlation","text":"\npair_type = PercusYevick(3; rtol = 1e-2, maxsize = 200)\n\nmicro = Microstructure(s, pair_type);\n\n# output","category":"page"},{"location":"manual/pair-correlation/","page":"Pair correlation","title":"Pair correlation","text":"and we can plot the result (needs the packages Plots and Image)","category":"page"},{"location":"manual/pair-correlation/","page":"Pair correlation","title":"Pair correlation","text":"using Plots\n\nplot(micro.paircorrelations[1].r, 1.0 .+ micro.paircorrelations[1].dp,\n    xlab = \"distance\", ylab = \"P-Y\"\n)","category":"page"},{"location":"manual/pair-correlation/","page":"Pair correlation","title":"Pair correlation","text":"(Image: ../PY-30-pair.png)","category":"page"},{"location":"manual/pair-correlation/","page":"Pair correlation","title":"Pair correlation","text":"which we can compare with Figure 8.3.1 from [1] below.","category":"page"},{"location":"manual/pair-correlation/","page":"Pair correlation","title":"Pair correlation","text":"(Image: ../TKD-PY-30.jpg)","category":"page"},{"location":"manual/pair-correlation/","page":"Pair correlation","title":"Pair correlation","text":"Note that for x  1 the two particles of radius 0.5 would overlap, so the pair correlation should be zero. Also note that dp is the variation from uncorrelated, which is why we add 1.0 to get the pair correlation.","category":"page"},{"location":"manual/pair-correlation/#Calculate-an-effective-wavenumber","page":"Pair correlation","title":"Calculate an effective wavenumber","text":"","category":"section"},{"location":"manual/pair-correlation/","page":"Pair correlation","title":"Pair correlation","text":"The more points sampled within the pair correlation the longer it will take to calculate the effective wavenumber.","category":"page"},{"location":"manual/pair-correlation/","page":"Pair correlation","title":"Pair correlation","text":"First we calculate the wavenumbers with the simplest pair correlation (hole correction), and then compare the results with Percus-Yevick.","category":"page"},{"location":"manual/pair-correlation/","page":"Pair correlation","title":"Pair correlation","text":"\nmicro = Microstructure(s);\n\nω = 0.4\n\nkps = wavenumbers(ω, medium, micro;\n    basis_order = 1, num_wavenumbers = 4\n)\n\npair_type = PercusYevick(3; meshsize = 0.1, maxsize = 50)\nmicro = Microstructure(s, pair_type);\n\nkps2 = wavenumbers(ω, medium, micro;\n    basis_order = 1, num_wavenumbers = 4\n)","category":"page"},{"location":"manual/pair-correlation/","page":"Pair correlation","title":"Pair correlation","text":"we can then compare how the wavenumbers change with Percus-Yevick with a scatter plot","category":"page"},{"location":"manual/pair-correlation/","page":"Pair correlation","title":"Pair correlation","text":"using Plots\n\nscatter(kps, lab = \"Hole correction\")\nscatter!(kps2, lab = \"Percus-Yevick\")\n","category":"page"},{"location":"manual/pair-correlation/","page":"Pair correlation","title":"Pair correlation","text":"(Image: ../kps-PY-30-pair.png)","category":"page"},{"location":"manual/pair-correlation/","page":"Pair correlation","title":"Pair correlation","text":"We can see that in this case, the effective wavenumbers with (kps2) and without (kps) Percus Yevick are quite different.","category":"page"},{"location":"manual/pair-correlation/#Calculate-reflection","page":"Pair correlation","title":"Calculate reflection","text":"","category":"section"},{"location":"manual/pair-correlation/","page":"Pair correlation","title":"Pair correlation","text":"To calculate the average reflection, or scattering, from a material is the same as before, except we just need to replace Species with Microstructure. For example to calculate reflection from a plate:","category":"page"},{"location":"manual/pair-correlation/","page":"Pair correlation","title":"Pair correlation","text":"\nk_eff = kps2[1]\n\nnormal = [0.0,0.0,-1.0] # an outward normal to both surfaces of the\nwidth = 150.0 # plate width\norigin = [0.0,0.0,width/2] # the centre of the plate\n\nplate = Plate(normal,width,origin)\n\n# note below we use micro instead of species\nmaterial = Material(plate, micro)\n\nsource = PlaneSource(medium, [0.0,0.0,-1.0])\n\n# Calculate the wavemode for the first wavenumber\n# the WaveMode function calculates the types of waves and solves the needed boundary conditions\nwavemodes = WaveMode(ω, k_eff, source, material; tol = 1e-6, basis_order = 1);\n\nRTeff = reflection_transmission_coefficients(wavemodes, source, material)\n\nabs.(RTeff)","category":"page"},{"location":"manual/pair-correlation/","page":"Pair correlation","title":"Pair correlation","text":"We can compare the result of not using Percus-Yevick below.","category":"page"},{"location":"manual/pair-correlation/","page":"Pair correlation","title":"Pair correlation","text":"k_eff = kps[1]\nmicro = Microstructure(s);\nmaterial = Material(plate, micro)\nwavemodes = WaveMode(ω, k_eff, source, material; tol = 1e-6, basis_order = 1);\n\nRTeff = reflection_transmission_coefficients(wavemodes, source, material)\n\nabs.(RTeff)","category":"page"},{"location":"manual/pair-correlation/#References","page":"Pair correlation","title":"References","text":"","category":"section"},{"location":"manual/pair-correlation/","page":"Pair correlation","title":"Pair correlation","text":"[1] Kong, Jin Au, Leung Tsang, Kung-Hau Ding, and Chi On Ao. Scattering of electromagnetic waves: numerical simulations. John Wiley & Sons, 2004.","category":"page"},{"location":"manual/pair-correlation/","page":"Pair correlation","title":"Pair correlation","text":"[2] Gerhard Kristensson. \"The Percus-Yevick approximation\". github.com/JuliaWaveScattering/EffectiveWaves.jl (2022).","category":"page"},{"location":"manual/pair-correlation/","page":"Pair correlation","title":"Pair correlation","text":"[3] Gower, Artur L., and Gerhard Kristensson. \"Effective waves for random three-dimensional particulate materials.\" New Journal of Physics 23.6 (2021): 063083.","category":"page"},{"location":"manual/wavenumbers/#Effective-wavenumbers","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"","category":"section"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"As the effective wavenumbers depend only on the microstructure, we need only specify the Species and the background's PhysicalMediums properties. At present only Acoustic mediums are defined.","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"In the background, this package solves the dispersion equation for plane-waves, as this is simpler. Though we are able to formulate and solve dispersion equations for other waves, see example ...","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"For the low frequency and low volume fraction limits, there exist simple analytic formulas that give only one effective wavenumber. Beyond these limits, there are multiple wavenumbers in the general case.","category":"page"},{"location":"manual/wavenumbers/#Low-frequency","page":"Effective wavenumbers","title":"Low frequency","text":"","category":"section"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"In the low frequency limit there are explicit formulas for any volume fraction of particles. These formulas have been confirmed by a number of different analytic methods.","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"For acoustics in 3 dimensions we can calculate the effective properties, which we illustrate for the effective density rho_* and bulk modulus beta_*:","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"frac1beta_* = frac1beta + fraclangleDelta beta_*ranglebeta","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"rho_* = rho frac1 -langleDelta rho_* rangle1 + 2 langleDelta rho_* rangle","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"where[1]","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"[1]: The sums below are actually approximations of integrals over varphi_j.","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"langle Delta beta_* rangle  =  sum_j fracbeta - beta_jbeta_j  varphi_j","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"and","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"langle Delta rho_* rangle  =  sum_j fracrho - rho_jrho + 2 rho_j   varphi_j","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"where varphi_j is the volume fraction occupied by the particles with the properties beta_j and rho_j, so that sum_j varphi_j = varphi, the total particle volume fraction. Note that for spheres varphi_j = frac4 pi a_j^33 n_j, where a_j is the radius of the j specie, and n_j is the number of particles of the j specie per volume.","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"We use the code below to calculate these quantities.","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"spatial_dim = 3\nmedium = Acoustic(spatial_dim; ρ=1.2, c=1.5)\n\n# Choose the species\nradius1 = 0.001\ns1 = Specie(\n    Acoustic(spatial_dim; ρ=10.2, c=10.1), radius1;\n    volume_fraction=0.2\n);\n\nradius2 = 0.002\ns2 = Specie(\n    Acoustic(spatial_dim; ρ=0.2, c=4.1), radius2;\n    volume_fraction=0.15\n);\nspecies = [s1,s2]\n\n# Choose the frequency\nω = 1e-2\nk = ω / real(medium.c)\n\n# Check that we are indeed in a low frequency limit\nk * radius2 < 1e-4\n\n# output\n\ntrue","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"From these we can get the effective sound speed c_* = sqrtbeta_* rho_* and the effective wavenumber k_* = omega  c_*.","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"eff_medium = effective_medium(medium, species)\neff_medium.c\n\n# output\n\n1.735082366476732 + 0.0im","category":"page"},{"location":"manual/wavenumbers/#Low-volume-fraction","page":"Effective wavenumbers","title":"Low volume fraction","text":"","category":"section"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"In the limit of a low volume fraction of particles, there we again have explicit formulas. These formulas are more accurate for weak scatterers, i.e. particles that do not scatter much energy.","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"\n# Choose the species\nradius1 = 0.3\ns1 = Specie(\n    Acoustic(spatial_dim; ρ=10.2, c=10.1), radius1;\n    volume_fraction=0.02\n);\n\nradius2 = 0.2\ns2 = Specie(\n    Acoustic(spatial_dim; ρ=0.2, c=4.1), radius2;\n    volume_fraction=0.03\n);\nspecies = [s1,s2]\n\n# Choose the frequency\nω = 1.0","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"As we are dealing with finite frequency, we can specify basis_order the number of multi-poles to consider. In 3D basis_order is maximum degree of the spherical harmonics. This parameter should be increased when increasing the frequency.","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"basis_order = 2\nk1 = wavenumber_low_volumefraction(ω, medium, species; basis_order = basis_order)\n\n# output\n\n0.6477267068908865 + 3.20821643199973e-5im","category":"page"},{"location":"manual/wavenumbers/#wavenumber_general","page":"Effective wavenumbers","title":"The general case","text":"","category":"section"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"In the general case, there are multiple effective wavenumbers k_p for the same incident frequency. These k_p require numerical optimisation to find (together with the help of asymptotics). This task can be the most computational demanding.","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"\n# Choose the species\nradius1 = 0.3\ns1 = Specie(\n    Acoustic(spatial_dim; ρ=10.2, c=10.1), radius1;\n    volume_fraction=0.2\n);\n\nradius2 = 0.2\ns2 = Specie(\n    Acoustic(spatial_dim; ρ=0.2, c=4.1), radius2;\n    volume_fraction=0.1\n);\nspecies = [s1,s2]\n\n# Choose the frequency\nω = 1.0\n\n# Calculate at least 5 of the effective wavenumbers\nkps = wavenumbers(ω, medium, species; basis_order = 2, num_wavenumbers = 5)","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"If you have the Plots package installed, you can then visualise the result","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"using Plots\n\nscatter(kps,\n    xlab = \"Im kp\", ylab = \"Re kp\", lab = \"\"\n    , title = \"Effective wavenumbers\")","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"(Image: multiple-wavenumbers.png)","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"In this case there is one effective wavenumber k_1 with an imaginary part much smaller than the others. This means that the wavemode phi_1 associated with k_1, see Theoretical background, is the only wavemode which makes a significant contribution.","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"However, be warned! It is easy to find a case where two effective wavenumbers become important. All we need to have is a specie that scatters wave strongly. Examples of this in acoustics are gas bubbles in a background liquid, or liquid/gas pockets in a background solid.","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"For example, we need only lower the sound speed of s1 above:","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"\n# Choose the species\ns2 = Specie(\n    Acoustic(spatial_dim; ρ=0.2, c=0.1), radius2;\n    volume_fraction=0.1\n);\nspecies = [s1,s2]\n\n# Calculate at least 5 of the effective wavenumbers\nkps = wavenumbers(ω, medium, species; basis_order = 2, num_wavenumbers = 5)","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"If you have the Plots package installed, you can then visualise the result","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"using Plots\n\nscatter(kps,\n    xlab = \"Im kp\", ylab = \"Re kp\", lab = \"\"\n    , title = \"Effective wavenumbers\")","category":"page"},{"location":"manual/wavenumbers/","page":"Effective wavenumbers","title":"Effective wavenumbers","text":"(Image: multiple-wavenumbers.png)","category":"page"},{"location":"library/library/#Base","page":"Library","title":"Base","text":"","category":"section"},{"location":"library/library/","page":"Library","title":"Library","text":"CurrentModule = EffectiveWaves","category":"page"},{"location":"library/library/","page":"Library","title":"Library","text":"Pages = [\"base.md\"]","category":"page"},{"location":"library/library/#Defining-the-material","page":"Library","title":"Defining the material","text":"","category":"section"},{"location":"library/library/","page":"Library","title":"Library","text":"PhysicalMedium\nAcoustic\nSpecie\nMaterial\nPlaneSource\nRegularSource","category":"page"},{"location":"library/library/#MultipleScattering.PhysicalMedium","page":"Library","title":"MultipleScattering.PhysicalMedium","text":"PhysicalMedium{Dim,FieldDim}\n\nAn abstract type used to represent the physical medium, the dimension of the field, and the number of spatial dimensions.\n\n\n\n\n\n","category":"type"},{"location":"library/library/#MultipleScattering.Acoustic","page":"Library","title":"MultipleScattering.Acoustic","text":"Acoustic{T<:AbstractFloat,Dim}(ρ::T, c::Complex{T})\nAcoustic(ρ::T, c::Union{T,Complex{AbstractFloat}}, Dim::Integer)\n\nPhysical properties for a homogenous isotropic acoustic medium with wavespeed (c) and density (ρ)\n\nSimulations in this medium produce scalar (1D) fields in Dim dimensions.\n\n\n\n\n\n","category":"type"},{"location":"library/library/#EffectiveWaves.Specie","page":"Library","title":"EffectiveWaves.Specie","text":"Specie\n\nRepresents a set of particles which are all the same. The type of particle is given by Specie.particle and the volume fraction this specie occupies is given by Specie.volume_fraction.\n\nWe can use Specie.numberofparticles to specify the number of particles, otherwise for an infinite Specie.numberofparticles = Inf.\n\nThe minimum distance between any two particles will equal outer_radius(Specie) * Specie.exclusion_distance.\n\n\n\n\n\n","category":"type"},{"location":"library/library/#EffectiveWaves.Material","page":"Library","title":"EffectiveWaves.Material","text":"Material(region::Shape, species::Species [, numberofparticles = Inf])\n\nCreates a material filled with Specie's inside region.\n\n\n\n\n\n","category":"type"},{"location":"library/library/#MultipleScattering.PlaneSource","page":"Library","title":"MultipleScattering.PlaneSource","text":"PlaneSource(medium::P, amplitude::SVector, direction::SVector)\n\nIs a struct type which describes a plane-wave source that drives/forces the whole system. It has three fields: a physical medium, an amplitude of the source, and the direction the propagate in direction.\n\nFor any given angular frequency ω, the PlaneSource has the value e^i ωc mathbf v cdot mathbf x  at the point mathbf x, where c is the medium wavespeed and mathbf v is the direction.\n\n\n\n\n\n","category":"type"},{"location":"library/library/#MultipleScattering.RegularSource","page":"Library","title":"MultipleScattering.RegularSource","text":"RegularSource(medium::P, field::Function, coef::Function)\n\nIs a struct type which describes the source field that drives/forces the whole system. It is also known as an incident wave. It has three fields RegularSource.medium, RegularSource.field, and RegularSource.coef.\n\nThe source field at the position 'x' and angular frequency 'ω' is given by\n\nx = [1.0,0.0]\nω = 1.0\nRegularSource.field(x,ω)\n\nThe field RegularSource.coef regularbasisfunction(medium::Acoustic{T,2}, ω::T)\n\n\n\n\n\n","category":"type"},{"location":"library/library/","page":"Library","title":"Library","text":"Currently the physical medium can be Acoustics. Both Acoustic, PlaneSource, and RegularSource are all imported from the package MultipleScattering. In the future these will be moved to a new package WaveScatteringBase. Much of the code is dispatched based on the underlying symmetries of the problem","category":"page"},{"location":"library/library/#The-symmetry-of-the-material-and-source","page":"Library","title":"The symmetry of the material and source","text":"","category":"section"},{"location":"library/library/","page":"Library","title":"Library","text":"The symmetry shared between the material shape and source are used to specialise the form of the wavemode, see Theoretical background.  ","category":"page"},{"location":"library/library/","page":"Library","title":"Library","text":"Symmetry\nWithoutSymmetry\nPlanarSymmetry\nAzimuthalSymmetry\nPlanarAzimuthalSymmetry\nRadialSymmetry","category":"page"},{"location":"library/library/#MultipleScattering.Symmetry","page":"Library","title":"MultipleScattering.Symmetry","text":"Symmetry(T1,T2)\n\nreturns the combined symmetry of the two objects T1 and T2.\n\n\n\n\n\n","category":"function"},{"location":"library/library/#MultipleScattering.WithoutSymmetry","page":"Library","title":"MultipleScattering.WithoutSymmetry","text":"WithoutSymmetry\n\nA type used to describe materials and incident waves which share no common symmetry. This will lead to the most general regular wave expansion for the eignvectors.\n\n\n\n\n\n","category":"type"},{"location":"library/library/#MultipleScattering.PlanarSymmetry","page":"Library","title":"MultipleScattering.PlanarSymmetry","text":"PlanarSymmetry\n\nA type used to describe materials and incident waves that both share a planar symmetry.\n\n\n\n\n\n","category":"type"},{"location":"library/library/#MultipleScattering.AzimuthalSymmetry","page":"Library","title":"MultipleScattering.AzimuthalSymmetry","text":"AzimuthalSymmetry\n\nA type used to describe materials and incident waves in 3 spatial dimensions that share a symmetry about the azimuth.\n\n\n\n\n\n","category":"type"},{"location":"library/library/#MultipleScattering.PlanarAzimuthalSymmetry","page":"Library","title":"MultipleScattering.PlanarAzimuthalSymmetry","text":"PlanarAzimuthalSymmetry\n\nA type used to describe a materail and incident wave which have both PlanarSymmetry and AzimuthalSymmetry.\n\n\n\n\n\n","category":"type"},{"location":"library/library/#MultipleScattering.RadialSymmetry","page":"Library","title":"MultipleScattering.RadialSymmetry","text":"RadialSymmetry\n\nA type used to describe materials and incident waves in that are both radially symmetric. That is, the material is a sphere, and the incident wave is radially symmetric around the center of this spherical material.\n\n\n\n\n\n","category":"type"},{"location":"library/library/#Types-of-waves","page":"Library","title":"Types of waves","text":"","category":"section"},{"location":"library/library/","page":"Library","title":"Library","text":"There are two main types used.","category":"page"},{"location":"library/library/","page":"Library","title":"Library","text":"EffectivePlaneWaveMode","category":"page"},{"location":"library/library/#EffectiveWaves.EffectivePlaneWaveMode","page":"Library","title":"EffectiveWaves.EffectivePlaneWaveMode","text":"EffectivePlaneWaveMode{T<:AbstractFloat,Dim} <: AbstractWaveMode{T,Dim}\n\nIs a struct that represents a mode of the average scattering coefficients for plane wave symmetry. That is, when using an incident plane wave and a plate or halfspace for the material geometry.\n\nThis wave mode has frequency omega and has has the value A e^i k mathbf v cdot mathbf x  at the point mathbf x, where A are the eigenvectors, mathbf v is the direction and k is the effective wavenumber. We represent these quantities as\n\nomega = EffectivePlaneWaveMode.ω\nk = EffectivePlaneWaveMode.wavenumber\nv = EffectivePlaneWaveMode.direction\nA = EffectivePlaneWaveMode.eigenvectors\nM = EffectivePlaneWaveMode.basis_order\n\nTo recover the average scattering coefficients F from a particle use:\n\nF_ns = i^m A_n s e^-i n  θ\n\nwhere n is multi-index for 3 dimensions and s ranges from 1 to the number of species.\n\nIn 2D, inconvieniently, an extra factor of e^i k mathbf v cdot mathbf x needs to be multiplied on the right of the above equation where θ is calculated from transmission_angle.\n\n\n\n\n\n","category":"type"},{"location":"library/library/","page":"Library","title":"Library","text":"EffectiveRegularWaveMode","category":"page"},{"location":"library/library/#EffectiveWaves.EffectiveRegularWaveMode","page":"Library","title":"EffectiveWaves.EffectiveRegularWaveMode","text":"EffectiveRegularWaveMode{T,Dim,P<:PhysicalMedium,S<:AbstractSymmetry} <: AbstractRegularWaveMode{T,Dim}\n\nIs a struct that represents a mode of the average scattering coefficients F in the form\n\nF_n s (mathbf r) =  sum_n_1 p A_p n n_1 s mathrm v_n_1(k mathbf r)\n\nwhere mathbf r is a position vector in space, k the wavenumber, p is used to count the number of eigenvectors, s the number of species, n and n_1 are multi-indices, and mathrm v_n_1 is a regular spherical wave of order n_1 which in 3D is given by\n\nmathrm v_n_1(mathbf r) = mathrm j_ell_1 (k r) mathrm Y_ell_1 m_1(hatmathbf r)\n\nand mathrm Y_ell_1 m_1 is a spherical harmonic, n_1 = (ell_1m_1) where we always have that ell_1 geq 0 and ell_1 geq m_1 according to the conventions of spherical harmonics.\n\nTo translate the mathematics to Julia code we use\n\nomega = EffectiveRegularWaveMode.ω\nk = EffectiveRegularWaveMode.wavenumber\nA = EffectiveRegularWaveMode.eigenvectors\nn = EffectiveRegularWaveMode.basis_order\nn_1 = EffectiveRegularWaveMode.basis_field_order\n\n\n\n\n\n","category":"type"},{"location":"library/library/#Effective-wavenumbers-and-wavemodes","page":"Library","title":"Effective wavenumbers and wavemodes","text":"","category":"section"},{"location":"library/library/","page":"Library","title":"Library","text":"wavenumbers\nwavenumber_low_volumefraction\neffective_medium","category":"page"},{"location":"library/library/#EffectiveWaves.wavenumbers","page":"Library","title":"EffectiveWaves.wavenumbers","text":"wavenumbers(ω, medium, specie; kws...)\n\nReturns all the possible effective wavenumbers with positive imaginary part when using a single type of particle called specie.\n\n\n\n\n\nwavenumbers(ω, medium::PhysicalMedium, micro::Microstructure; kws...)\n\nReturns all the possible effective wavenumbers with positive imaginary part. This function requires significantly numerical optimisation and so can be slow.\n\n\n\n\n\n","category":"function"},{"location":"library/library/#EffectiveWaves.wavenumber_low_volumefraction","page":"Library","title":"EffectiveWaves.wavenumber_low_volumefraction","text":"wavenumber_low_volumefraction(ω::T, medium::Acoustic{T,Dim}, micro::Microstructure{Dim}; basis_order::Int = 2)\n\nExplicit formula for one effective wavenumber based on a low particle volume fraction expansion.\n\n\n\n\n\n","category":"function"},{"location":"library/library/#EffectiveWaves.effective_medium","page":"Library","title":"EffectiveWaves.effective_medium","text":"The effective low frequency bulk modulus and density of a material filled with particles\n\n\n\n\n\n","category":"function"},{"location":"library/library/#Effective-wavemodes-and-eignvectors","page":"Library","title":"Effective wavemodes and eignvectors","text":"","category":"section"},{"location":"library/library/","page":"Library","title":"Library","text":"WaveMode\nWaveModes","category":"page"},{"location":"library/library/#EffectiveWaves.WaveMode","page":"Library","title":"EffectiveWaves.WaveMode","text":"WaveMode(ω::T, wavenumber::Complex{T}, eigenvectors::Array{Complex{T}}, ::SetupSymmetry; kws...)\n\nReturns a concrete subtype of AbstractWaveMode depending on the SetupSymmetry. The returned type should have all the necessary fields to calculate scattered waves (currently not true for EffectivePlanarWaves).\n\n\n\n\n\n","category":"function"},{"location":"library/library/#EffectiveWaves.WaveModes","page":"Library","title":"EffectiveWaves.WaveModes","text":"Calculates the effective wavenumbers and return Vector{EffectivePlaneWaveMode}.\n\n\n\n\n\n","category":"function"},{"location":"library/library/#Reflection-coefficients","page":"Library","title":"Reflection coefficients","text":"","category":"section"},{"location":"library/library/","page":"Library","title":"Library","text":"reflection_coefficient\nreflection_coefficient(::T, ::EffectivePlaneWaveMode{T}, ::PlaneSource{T,2,1,Acoustic{T,2}}, ::Material{2,Halfspace{T,2}}) where T<:AbstractFloat\nreflection_coefficient_low_volumefraction","category":"page"},{"location":"library/library/#EffectiveWaves.reflection_coefficient","page":"Library","title":"EffectiveWaves.reflection_coefficient","text":"Calculates the reflection coefficient from each wave in waves and then sums the results.\n\n\n\n\n\nreflection_coefficient(PlaneSource, Acoustic[, Halfspace = Halfspace(-psource.direction)])\n\ncalculates the reflection coefficient from a homogenious halfspace (assumed to direct incidence if not given), which is also the low frequency reflection from a particulate material when using the effective_medium.\n\n\n\n\n\nreflection_coefficient(ω::T, wave_eff::EffectivePlaneWaveMode, psource::PlaneSource{T,2,1,Acoustic}, material::Material{2,Halfspace}; [x::T = zero(T)])\n\nThe reflection coefficient in 2D for acoustics for just one EffectivePlaneWaveMode\"\n\n\n\n\n\nreflection_coefficient(ω::T, m_wave::MatchPlaneWaveMode,\n    source::PlaneSource, material::Material{2,Halfspace{T,2}};\n\nCalculate the reflection coefficient from a matched wave. This requires using both the discrete part and effective wavemode of the matched wave.\n\n\n\n\n\n","category":"function"},{"location":"library/library/#EffectiveWaves.reflection_coefficient-Union{Tuple{T}, Tuple{T,EffectivePlaneWaveMode{T,Dim} where Dim,PlaneSource{T,2,1,Acoustic{T,2}},Material{2,Halfspace{T,2}}}} where T<:AbstractFloat","page":"Library","title":"EffectiveWaves.reflection_coefficient","text":"reflection_coefficient(ω::T, wave_eff::EffectivePlaneWaveMode, psource::PlaneSource{T,2,1,Acoustic}, material::Material{2,Halfspace}; [x::T = zero(T)])\n\nThe reflection coefficient in 2D for acoustics for just one EffectivePlaneWaveMode\"\n\n\n\n\n\n","category":"method"},{"location":"library/library/#EffectiveWaves.reflection_coefficient_low_volumefraction","page":"Library","title":"EffectiveWaves.reflection_coefficient_low_volumefraction","text":"An explicit formula for the refleciton coefficient based on a low particle volume fraction.\n\n\n\n\n\n","category":"function"},{"location":"library/library/#Transmission","page":"Library","title":"Transmission","text":"","category":"section"},{"location":"library/library/","page":"Library","title":"Library","text":"transmission_direction\ntransmission_angle(::Vector,::Vector)\ntransmission_angle(::SVector{2,CT} where CT <: Union{T,Complex{T}}, ::SVector{2,T}) where {T<:AbstractFloat}\ntransmission_angle(::SVector{3,CT} where CT <: Union{T,Complex{T}}, ::SVector{3,T}) where {T<:AbstractFloat}","category":"page"},{"location":"library/library/#EffectiveWaves.transmission_direction","page":"Library","title":"EffectiveWaves.transmission_direction","text":"transmission_direction(k_eff::Complex, incident_wavevector::AbstractArray, surface_normal::AbstractArray)\n\nGives the effective direction direction where sum(direction .^ 2) = 1.0 and the components of k_eff .* direction and incident_wavevector which are orthogonal to the surface are the same. Note surface_normal is the outward pointing normal and the incident medium's wavenumber k = sqrt(sum(incident_wavevector .^2)). Below we deduce the result.\n\nAssume that dot(v,w) = conj(v[i])w[i] and surface_normal[i]*surface_normal[i] = 1. Let wnp be orthogonal to surface_normal\n\nwnp =  incident_wavevector -  dot(surface_normal,incident_wavevector) .* surface_normal\n\nThen we know that the effective transmission wavevector has to equal\n\nk_eff_vec = wnp + α .* surface_normal\n\nwhere α is determined so that\n\nsum(x^2 for x in wnp) + α^2  = sum(x^2 for x in k_eff_vec) = k_eff^2\n\n\n\n\n\n","category":"function"},{"location":"library/library/#EffectiveWaves.transmission_angle-Tuple{Array{T,1} where T,Array{T,1} where T}","page":"Library","title":"EffectiveWaves.transmission_angle","text":"transmission_angle(wavevector, surface_normal)\n\nCalculates the transmission angle for a wave propagting inside a material which has the outward normal surface_normal. The wave propagates in the direction of wavevector with a wavenumber given by k = sqrt(sum(wavevector .^2)), where k should have a positive imaginary part.\n\n\n\n\n\n","category":"method"},{"location":"library/library/#EffectiveWaves.transmission_angle-Union{Tuple{T}, Tuple{StaticArrays.SArray{Tuple{2},CT,1,2} where CT<:Union{Complex{T}, T},StaticArrays.SArray{Tuple{2},T,1,2}}} where T<:AbstractFloat","page":"Library","title":"EffectiveWaves.transmission_angle","text":"transmission_angle(wavevector::StaticVector{2}, surface_normal::StaticVector{2})\n\nSpecialised to 2 spatial dimensions.\n\n\n\n\n\n","category":"method"},{"location":"library/library/#EffectiveWaves.transmission_angle-Union{Tuple{T}, Tuple{StaticArrays.SArray{Tuple{3},CT,1,3} where CT<:Union{Complex{T}, T},StaticArrays.SArray{Tuple{3},T,1,3}}} where T<:AbstractFloat","page":"Library","title":"EffectiveWaves.transmission_angle","text":"transmission_angle(wavevector::StaticVector{3}, surface_normal::StaticVector{3})\n\nSome care is needed when wavevector is a complex vector in 3 dimensions.\n\nThe maths\n\nLet's define the normal projection vn:\n\nn = - surface_normal\nvn = dot(n,wavevector) .* n\n\nremembering that in Julia, and mathematics, dot(v,w) = sum(conj(v[i])*w[i] for i in eachindex(v)).\n\nWe now define the orthogonal component vo and its direction no:\n\nvo = wavevector - vn\nno = vo / sqrt(sum(vo.^2))\n\nNote this assumes that vo is a real vector, which it should be due to symmetry.\n\nTo determine the transmission angle θT we calculate the wavenumber\n\nk = ± sqrt(sum(wavevector .^2))\n\nwhere we choose the sign in ± such that imag(k) >= 0.\n\nFrom the above we can write the wavevector in the form\n\nwavevector = k .* (n .* cos(θ) + no .* sin(θ))\n\nwhich implies that\n\nk * cos(θ) = dot(conj(n), wavevector)\nk * sin(θ) = dot(conj(no),wavevector) = dot(conj(no),vo) = sqrt(sum(vo.^2))\n\nFrom these two we can robustly calculate θT as\n\nθT = atan(sqrt(sum(vo.^2)),dot(n,wavevector))\n\n\n\n\n\n","category":"method"},{"location":"#EffectiveWaves.jl-Documentation","page":"Home","title":"EffectiveWaves.jl Documentation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"A Julia package for calculating, processing and plotting waves travelling in heterogeneous materials. The focus is on ensemble averaged waves.","category":"page"},{"location":"","page":"Home","title":"Home","text":"At present, the package focuses on materails filled with randomly placed particles. You can calculate effective wavenumbers for 2D [1] and 3D [4] acoustics, wave transimission and wave reflection in 2D [1,2,3] and 3D [4], and scattering from an inhomogenious sphere [4]. See these notes for brief formulas on effective wavenumbers.","category":"page"},{"location":"","page":"Home","title":"Home","text":"Together with MultipleScattering.jl, this package has been setup to easily extend to other dimensions, materials, and types of waves, such as elastic and electromagnetic waves.","category":"page"},{"location":"","page":"Home","title":"Home","text":"note: Note\nFirst install Julia v1.0.5 or later, then run in the Julia REPL:using Pkg\nPkg.add EffectiveWavesAlternatively, use the Julia package manager. From the Julia REPL, type ] to enter the Pkg REPL mode and then runpkg> add EffectiveWaves","category":"page"},{"location":"#Manual","page":"Home","title":"Manual","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"You can learn to use this package through examples or through our manual, which starts with a Quick introduction.","category":"page"},{"location":"#References","page":"Home","title":"References","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"[1] Gower AL, Smith MJ, Parnell WJ, Abrahams ID. Reflection from a multi-species material and its transmitted effective wavenumber. Proc. R. Soc. A. 2018 Apr 1;474(2212):20170864.","category":"page"},{"location":"","page":"Home","title":"Home","text":"[2] Gower, Artur L., William J. Parnell, and I. David Abrahams. \"Multiple waves propagate in random particulate materials.\" SIAM Journal on Applied Mathematics 79.6 (2019): 2569-2592.","category":"page"},{"location":"","page":"Home","title":"Home","text":"[3] Gower, Artur L., I. David Abrahams, and William J. Parnell. \"A proof that multiple waves propagate in ensemble-averaged particulate materials.\" Proceedings of the Royal Society A 475.2229 (2019): 20190344.","category":"page"},{"location":"","page":"Home","title":"Home","text":"[4] Gower, Artur Lewis, and Gerhard Kristensson. \"Effective Waves for Random Three-dimensional Particulate Materials.\" arXiv preprint arXiv:2010.00934 (2020).","category":"page"},{"location":"#Contents","page":"Home","title":"Contents","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Depth = 1","category":"page"},{"location":"examples/vary_two_species/README/#Vary-volume-fraction-of-the-two-species","page":"Vary volume fraction of the two species","title":"Vary volume fraction of the two species","text":"","category":"section"},{"location":"examples/vary_two_species/README/","page":"Vary volume fraction of the two species","title":"Vary volume fraction of the two species","text":"DocTestSetup = quote\n    using EffectiveWaves\nend","category":"page"},{"location":"examples/vary_two_species/README/","page":"Vary volume fraction of the two species","title":"Vary volume fraction of the two species","text":"Here we demonstrate how varying the volume fraction of two different species of particles changes the effective wave speed and attenuation.","category":"page"},{"location":"examples/vary_two_species/README/#Define-the-material","page":"Vary volume fraction of the two species","title":"Define the material","text":"","category":"section"},{"location":"examples/vary_two_species/README/","page":"Vary volume fraction of the two species","title":"Vary volume fraction of the two species","text":"using EffectiveWaves\n\n# for fixed total volume fraction\nbackground = Acoustic(3; ρ = 1.0, c = 1.0) # 3 for a 3D material.\n\n\ngas_particle = Particle(Acoustic(3; ρ = 0.3, c = 0.3), 0.5) # 0.5 is the radius\nsolid_particle = Particle(Acoustic(3; ρ = 1000.0, c = 1000.0), 1.5)","category":"page"},{"location":"examples/vary_two_species/README/#Calculate-how-the-wavenumbers-change-when-varying-the-volume-fractions","page":"Vary volume fraction of the two species","title":"Calculate how the wavenumbers change when varying the volume fractions","text":"","category":"section"},{"location":"examples/vary_two_species/README/","page":"Vary volume fraction of the two species","title":"Vary volume fraction of the two species","text":"ωs = LinRange(0.01,0.5,200)\n\nN=5\nvolumefraction = 0.1\nvols = LinRange(0.0,volumefraction,N)\n\nks_arr = map(1:N) do i\n    sp1 = Specie(gas_particle; volume_fraction = vols[i])\n    sp2 = Specie(solid_particle; volume_fraction = volumefraction-vols[i])\n    [ wavenumber_low_volumefraction(ω, background, [sp1,sp2]) for ω in ωs]\nend\n\nspeeds = [ ωs ./ real(ks) for ks in ks_arr]\nattenuations = imag.(ks_arr)","category":"page"},{"location":"examples/vary_two_species/README/#Plot-the-results","page":"Vary volume fraction of the two species","title":"Plot the results","text":"","category":"section"},{"location":"examples/vary_two_species/README/","page":"Vary volume fraction of the two species","title":"Vary volume fraction of the two species","text":"labs = reshape( map(v -> \"void vol = $(Int(round(100*v)))%\",vols),1, length(vols));\np1 = plot(ωs, speeds,\n    labels=labs,\n    ylabel=\"wave speed (m/s)\" ,xlabel=\"frequency\"\n);\np2 = plot(ωs, attenuations,\n    labels=labs, xlabel=\"frequency\", ylabel=\"attenuation (1/m)\");\nplot(p1,p2,layout=(2,1))","category":"page"},{"location":"examples/vary_two_species/README/","page":"Vary volume fraction of the two species","title":"Vary volume fraction of the two species","text":"(Image: vary_volfrac.png)","category":"page"}]
}
