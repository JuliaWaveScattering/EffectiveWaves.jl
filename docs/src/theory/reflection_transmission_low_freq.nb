(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     46591,       1235]
NotebookOptionsPosition[     43605,       1177]
NotebookOutlinePosition[     43993,       1193]
CellTagsIndexPosition[     43950,       1190]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Low frequency Reflection and transmission", "Subsection",
 CellChangeTimes->{{3.906541843416709*^9, 
  3.906541854592237*^9}},ExpressionUUID->"fc2d53ca-f1df-4305-9756-\
5a2ef579fb84"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "T", ",", "R", ",", "P1", ",", "P2", ",", "k1", ",", "k2", ",", "uin", 
     ",", "uR", ",", "uT"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kin", " ", "=", " ", 
   RowBox[{"k1", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]1", "]"}], ",", 
      RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uin", "[", "x_", "]"}], ":=", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"x", ".", "kin"}]}]]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kR", " ", "=", " ", 
   RowBox[{"k1", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], ",", 
      RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uR", "[", "x_", "]"}], ":=", 
   RowBox[{"R", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"x", ".", "kR"}]}]]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kT", " ", "=", " ", 
   RowBox[{"k2", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]2", "]"}], ",", 
      RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uT", "[", "x_", "]"}], ":=", 
   RowBox[{"T", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"x", ".", "kT"}]}]]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X0", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "y"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"X", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"x", ",", "y"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"uin", "[", "X0", "]"}], " ", "+", " ", 
      RowBox[{"uR", "[", "X0", "]"}], " ", "-", 
      RowBox[{"uT", "[", "X0", "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["1", "\[Rho]1"], " ", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"uin", "[", "X", "]"}], ",", "x"}], "]"}]}], " ", "+", 
       RowBox[{
        FractionBox["1", "\[Rho]1"], 
        RowBox[{"D", "[", " ", 
         RowBox[{
          RowBox[{"uR", "[", "X", "]"}], ",", "x"}], "]"}]}], " ", "-", 
       RowBox[{
        FractionBox["1", "\[Rho]2"], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"uT", "[", "X", "]"}], ",", "x"}], "]"}]}]}], "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "->", "X0"}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"subSnells", " ", "=", " ", 
   RowBox[{"{", "  ", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]2", "]"}], " ", "->", "  ", 
     RowBox[{"k1", "  ", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]1", "]"}], "/", "k2"}]}]}], " ", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"subsol", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Flatten", "@", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{"eqs", "==", " ", "0"}], "]"}], "/.", "subSnells"}], ",", 
       RowBox[{"{", 
        RowBox[{"R", ",", "T"}], "}"}]}], "]"}]}], "/.", " ", 
    RowBox[{"k1", " ", "->", " ", 
     RowBox[{"Q", " ", "k2", " ", 
      RowBox[{"\[Rho]1", "/", "\[Rho]2"}]}]}]}], " ", "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.906541843416709*^9, 3.906542195715724*^9}, {
  3.906542229477569*^9, 3.906542268783965*^9}, {3.906542314159116*^9, 
  3.906542336427779*^9}, {3.906542451667676*^9, 3.9065424769550533`*^9}, {
  3.906542728456843*^9, 3.906542728602861*^9}, {3.906542769766479*^9, 
  3.906542771001995*^9}, {3.9163110611893473`*^9, 3.916311101609243*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"505ed892-b0ee-4b93-bf20-789175b2a272"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x", ",", "y"}], "}"}]], "Output",
 CellChangeTimes->{{3.9065420170841618`*^9, 3.906542045835774*^9}, {
   3.906542135646899*^9, 3.906542196986534*^9}, 3.906542269001123*^9, 
   3.906542336756316*^9, 3.906542477180331*^9, 3.906542729035215*^9, 
   3.906542772845778*^9, {3.916311047778927*^9, 3.916311102578001*^9}},
 CellLabel->"Out[62]=",ExpressionUUID->"fc2f5679-1c2b-49fa-882b-1731f835a4da"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"R", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"Q", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "-", 
      RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], 
     RowBox[{
      RowBox[{"Q", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]]}], ",", 
   RowBox[{"T", "\[Rule]", 
    FractionBox[
     RowBox[{"2", " ", "Q", " ", 
      RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], 
     RowBox[{
      RowBox[{"Q", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9065420170841618`*^9, 3.906542045835774*^9}, {
   3.906542135646899*^9, 3.906542196986534*^9}, 3.906542269001123*^9, 
   3.906542336756316*^9, 3.906542477180331*^9, 3.906542729035215*^9, 
   3.906542772845778*^9, {3.916311047778927*^9, 3.916311102600688*^9}},
 CellLabel->"Out[65]=",ExpressionUUID->"fbf24fc6-1eef-40cf-8680-2c99a27abd01"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"$Assumptions", " ", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Pi]"}], "/", "2"}], " ", "<", "\[Theta]1", "<", 
        RowBox[{"\[Pi]", "/", "2"}]}], " ", ",", 
       RowBox[{"Q", " ", ">", "0"}], ",", 
       RowBox[{"\[Rho]s", ">", "0"}], ",", 
       RowBox[{"\[Beta]s", ">", "0"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "R"}], ")"}], "^", "2"}], " ", "-", " ", 
      RowBox[{"T", "^", "2"}]}], " ", "/.", "subsol"}], " ", "//", 
    "FullSimplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "+", "R", " ", "-", " ", "T"}], " ", "/.", "subsol"}], " ", 
    "//", "FullSimplify"}]}]}]], "Input",
 CellChangeTimes->{{3.906542773407077*^9, 3.906542874213883*^9}, {
  3.906542951257341*^9, 3.906542976133801*^9}, {3.906543279152937*^9, 
  3.906543299993977*^9}, {3.906545507138607*^9, 3.90654551040915*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"5fa6d3ee-515e-4d4f-b620-3b3d999753b5"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.906542954688129*^9, 3.9065429769515877`*^9}, {
   3.906543283627199*^9, 3.9065433002558603`*^9}, 3.9065455107322483`*^9, 
   3.9163111082965727`*^9},
 CellLabel->"Out[67]=",ExpressionUUID->"3cb4d945-6e85-4b2c-9d5a-f43d2f9542d4"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.906542954688129*^9, 3.9065429769515877`*^9}, {
   3.906543283627199*^9, 3.9065433002558603`*^9}, 3.9065455107322483`*^9, 
   3.916311108297324*^9},
 CellLabel->"Out[68]=",ExpressionUUID->"3bb59479-0d48-4621-9aaa-1626fcf721a3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Low frequency for particulate material\
\>", "Subsubsection",
 CellChangeTimes->{{3.906545329936282*^9, 3.9065453419857388`*^9}, {
  3.906545401072734*^9, 3.9065455012072144`*^9}, {3.906545533421897*^9, 
  3.906545546482091*^9}},ExpressionUUID->"d1cb2ce3-807f-4d39-b7c9-\
8c9054dbea11"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$Assumptions", " ", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Pi]"}], "/", "2"}], " ", "<", "\[Theta]1", "<", 
       RowBox[{"\[Pi]", "/", "2"}]}], " ", ",", 
      RowBox[{"Q", " ", ">", "0"}], ",", 
      RowBox[{"\[Rho]s", ">", "0"}], ",", 
      RowBox[{"\[Beta]s", ">", "0"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"T", "/.", "subsol"}], "/.", 
     RowBox[{"{", 
      RowBox[{"Q", "->", " ", 
       RowBox[{"k1", " ", "/", 
        RowBox[{"(", " ", 
         RowBox[{"k2", " ", 
          RowBox[{"\[Rho]1", "/", "\[Rho]2"}]}], ")"}]}]}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k1", "->", " ", 
       RowBox[{"\[Omega]", "/", "c"}]}], ",", 
      RowBox[{"k2", "->", " ", 
       RowBox[{"\[Omega]", "/", "cs"}]}]}], "}"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"cs", " ", "->", " ", 
      SqrtBox[
       RowBox[{"\[Beta]s", "/", "\[Rho]s"}]]}], ",", 
     RowBox[{"\[Rho]2", "->", "\[Rho]s"}], ",", 
     RowBox[{"\[Rho]1", "->", "\[Rho]"}]}], "}"}]}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.906545329936282*^9, 3.9065453419857388`*^9}, {
  3.906545401072734*^9, 3.9065455012072144`*^9}, {3.906545533421897*^9, 
  3.906545558005048*^9}, {3.906545644706266*^9, 
  3.9065456569924603`*^9}},ExpressionUUID->"54e62f58-fdf6-4b56-9122-\
ce13eef202da"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   SqrtBox[
    RowBox[{"\[Beta]s", " ", "\[Rho]s"}]], " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], 
  RowBox[{
   RowBox[{
    SqrtBox[
     RowBox[{"\[Beta]s", " ", "\[Rho]s"}]], " ", 
    RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
   RowBox[{"c", " ", "\[Rho]", " ", 
    RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}]]], "Output",
 CellChangeTimes->{
  3.90654534242199*^9, 3.906545412682164*^9, {3.906545452010668*^9, 
   3.906545458329794*^9}, {3.906545493416338*^9, 3.906545512479508*^9}, 
   3.906545552429125*^9, 3.906545638086965*^9},
 CellLabel->
  "Out[196]=",ExpressionUUID->"76976d20-2cfb-47b0-b25a-51817d64923f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  StyleBox[
   RowBox[{
   "Low", " ", "frequency", " ", "for", "  ", "tranmission", " ", "through", 
    " ", "a", " ", "plate"}], "Subsubsection"]}]], "Input",
 CellChangeTimes->{{3.91630872807594*^9, 3.916308744592492*^9}, {
  3.916310712754608*^9, 
  3.9163107253947697`*^9}},ExpressionUUID->"0028ab2b-a57b-4f16-ae70-\
6bbe3d5fc8e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "Consider", " ", "a", " ", "plate", "  ", "in", " ", "the", " ", "region", 
    "  ", "z1"}], " ", "<", " ", "z", " ", "<", " ", 
   RowBox[{
    RowBox[{"z2", ".", " ", "If"}], " ", "this", " ", "is", " ", "the", " ", 
    "effective", " ", "limit", " ", "of", " ", "a", " ", "particulate"}]}], 
  ",", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
    "than", " ", "the", " ", "particle", " ", "centres", " ", "are", " ", 
     "in", " ", "the", " ", "region", " ", "z1"}], " ", "<", " ", "z", " ", 
    "<", " ", 
    RowBox[{
     RowBox[{"z2", ".", " ", "Let"}], " ", "\[Zeta]1"}]}], " ", "=", " ", 
   RowBox[{"k", " ", "z1"}]}], ",", " ", 
  RowBox[{"\[Zeta]2", " ", "=", " ", 
   RowBox[{"k", " ", 
    RowBox[{"z2", ".", "  ", "The"}], " ", "plate", " ", "has", " ", 
    "properties", " ", "\[Rho]s", " ", "and", " ", "cs"}]}], ",", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"with", " ", "qs"}], " ", "=", " ", 
    RowBox[{"\[Rho]s", " ", "cs"}]}], " ", ";"}]}]], "Input",
 CellChangeTimes->{{3.91630872807594*^9, 3.916308825014617*^9}, {
  3.916309088709805*^9, 
  3.916309147429667*^9}},ExpressionUUID->"f518e691-2764-48d5-93d6-\
9b4a69e0aebd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "T", ",", "R", ",", "P1", ",", "P2", ",", "k1", ",", "k2", ",", "uin", 
     ",", "uR", ",", "uT"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kin", " ", "=", " ", 
   RowBox[{"k1", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]1", "]"}], ",", 
      RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uin", "[", "x_", "]"}], ":=", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"x", ".", "kin"}]}]]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kR", " ", "=", " ", 
   RowBox[{"k1", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], ",", 
      RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uR", "[", "x_", "]"}], ":=", 
   RowBox[{"R", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"x", ".", "kR"}]}]]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kP1", " ", "=", " ", 
   RowBox[{"k2", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]2", "]"}], ",", 
      RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uP1", "[", "x_", "]"}], ":=", 
   RowBox[{"P1", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"x", ".", "kP1"}]}]]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kP2", " ", "=", " ", 
   RowBox[{"k2", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], ",", 
      RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uP2", "[", "x_", "]"}], ":=", 
   RowBox[{"P2", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"x", ".", "kP2"}]}]]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kT", " ", "=", " ", 
   RowBox[{"k1", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]3", "]"}], ",", 
      RowBox[{"Sin", "[", "\[Theta]3", "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uT", "[", "x_", "]"}], ":=", 
   RowBox[{"T", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"x", ".", "kT"}]}]]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X1", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "y"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X2", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"x2", ",", "y"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"X", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"x", ",", "y"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"uin", "[", "X1", "]"}], " ", "+", " ", 
      RowBox[{"uR", "[", "X1", "]"}], " ", "-", 
      RowBox[{"uP1", "[", "X1", "]"}], "-", " ", 
      RowBox[{"uP2", "[", "X1", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["1", "\[Rho]1"], " ", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"uin", "[", "X", "]"}], "+", 
           RowBox[{"uR", "[", "X", "]"}]}], ",", "x"}], "]"}]}], " ", "-", 
       RowBox[{
        FractionBox["1", "\[Rho]2"], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"uP1", "[", "X", "]"}], "+", " ", 
           RowBox[{"uP2", "[", "X", "]"}]}], ",", "x"}], "]"}]}]}], "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "->", "X1"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"uT", "[", "X2", "]"}], " ", "-", 
      RowBox[{"uP1", "[", "X2", "]"}], "-", " ", 
      RowBox[{"uP2", "[", "X2", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["1", "\[Rho]1"], " ", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"uT", "[", "X", "]"}], ",", "x"}], "]"}]}], " ", "-", 
       RowBox[{
        FractionBox["1", "\[Rho]2"], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"uP1", "[", "X", "]"}], "+", " ", 
           RowBox[{"uP2", "[", "X", "]"}]}], ",", "x"}], "]"}]}]}], "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "->", "X2"}], "]"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"subSnells", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"\[Theta]3", " ", "->", " ", "\[Theta]1"}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]2", "]"}], " ", "->", "  ", 
      RowBox[{"k1", "  ", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Theta]1", "]"}], "/", "k2"}]}]}]}], " ", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"subsol", " ", "=", " ", 
  RowBox[{
   RowBox[{"Flatten", "@", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Thread", "[", 
        RowBox[{"eqs", "==", " ", "0"}], "]"}], "//.", "subSnells"}], ",", 
      RowBox[{"{", 
       RowBox[{"R", ",", "T", ",", "P1", ",", "P2"}], "}"}]}], "]"}]}], 
   RowBox[{"(*", 
    RowBox[{"/.", " ", 
     RowBox[{"k1", " ", "->", " ", 
      RowBox[{"Q", " ", "k2", " ", 
       RowBox[{"\[Rho]1", "/", "\[Rho]2"}]}]}]}], "*)"}], " ", "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.916310757596171*^9, 3.916310803825959*^9}, {
   3.9163108371698017`*^9, 3.916310849889801*^9}, {3.9163109011375837`*^9, 
   3.916311027162562*^9}, {3.916311115609462*^9, 3.916311284904895*^9}, {
   3.9163113799386*^9, 3.916311394482524*^9}, {3.916311426640787*^9, 
   3.9163114270258093`*^9}, 3.916311474276861*^9, {3.916382402189849*^9, 
   3.9163824234690104`*^9}, 3.9169793377431507`*^9},
 CellLabel->"In[23]:=",ExpressionUUID->"55751fef-0974-4177-ba5a-bc71fb3567d7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x", ",", "y"}], "}"}]], "Output",
 CellChangeTimes->{3.9163114748345833`*^9, 3.916311852898614*^9, 
  3.9163824296590137`*^9, 3.916979292269546*^9, 3.916979338036211*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"d23a16fe-8428-427c-93eb-78158897f762"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"R", "\[Rule]", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "k1", " ", "x1", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x1", " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]], "-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x2", " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"k1", " ", "\[Rho]2", " ", 
         RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "-", 
        RowBox[{"k2", " ", "\[Rho]1", " ", 
         RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"k1", " ", "\[Rho]2", " ", 
         RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
        RowBox[{"k2", " ", "\[Rho]1", " ", 
         RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x1", " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]], "-", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x2", " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]]}], ")"}], " ", 
       SuperscriptBox["k1", "2"], " ", 
       SuperscriptBox["\[Rho]2", "2"], " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x1", " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]], "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x2", " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]]}], ")"}], " ", "k1", " ",
        "k2", " ", "\[Rho]1", " ", "\[Rho]2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x1", " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]], "-", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x2", " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]]}], ")"}], " ", 
       SuperscriptBox["k2", "2"], " ", 
       SuperscriptBox["\[Rho]1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "\[Theta]2", "]"}], "2"]}]}]]}], ",", 
   RowBox[{"T", "\[Rule]", 
    FractionBox[
     RowBox[{"4", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k1", " ", 
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2"}], ")"}], " ", 
           RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
          RowBox[{"k2", " ", 
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2"}], ")"}], " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], ")"}]}]], " ", "k1", 
      " ", "k2", " ", "\[Rho]1", " ", "\[Rho]2", " ", 
      RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
      RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x1", " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]], "-", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x2", " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]]}], ")"}], " ", 
       SuperscriptBox["k1", "2"], " ", 
       SuperscriptBox["\[Rho]2", "2"], " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x1", " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]], "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x2", " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]]}], ")"}], " ", "k1", " ",
        "k2", " ", "\[Rho]1", " ", "\[Rho]2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x1", " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]], "-", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x2", " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]]}], ")"}], " ", 
       SuperscriptBox["k2", "2"], " ", 
       SuperscriptBox["\[Rho]1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "\[Theta]2", "]"}], "2"]}]}]]}], ",", 
   RowBox[{"P1", "\[Rule]", 
    FractionBox[
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "x1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k1", " ", 
           RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
          RowBox[{"k2", " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], ")"}]}]], " ", "k1", 
      " ", "\[Rho]2", " ", 
      RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"k1", " ", "\[Rho]2", " ", 
         RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
        RowBox[{"k2", " ", "\[Rho]1", " ", 
         RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x1", " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]], "-", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x2", " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]]}], ")"}], " ", 
       SuperscriptBox["k1", "2"], " ", 
       SuperscriptBox["\[Rho]2", "2"], " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x1", " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]], "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x2", " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]]}], ")"}], " ", "k1", " ",
        "k2", " ", "\[Rho]1", " ", "\[Rho]2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x1", " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]], "-", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x2", " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]]}], ")"}], " ", 
       SuperscriptBox["k2", "2"], " ", 
       SuperscriptBox["\[Rho]1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "\[Theta]2", "]"}], "2"]}]}]]}], ",", 
   RowBox[{"P2", "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k1", " ", "x1", " ", 
            RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
           RowBox[{"k2", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "+", 
              RowBox[{"2", " ", "x2"}]}], ")"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], ")"}]}]], " ", "k1", 
       " ", "\[Rho]2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k1", " ", "\[Rho]2", " ", 
          RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "-", 
         RowBox[{"k2", " ", "\[Rho]1", " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x1", " ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]], "-", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x2", " ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]]}], ")"}], " ", 
        SuperscriptBox["k1", "2"], " ", 
        SuperscriptBox["\[Rho]2", "2"], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Theta]1", "]"}], "2"]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x1", " ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x2", " ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]]}], ")"}], " ", "k1", 
        " ", "k2", " ", "\[Rho]1", " ", "\[Rho]2", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x1", " ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]], "-", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x2", " ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]]}], ")"}], " ", 
        SuperscriptBox["k2", "2"], " ", 
        SuperscriptBox["\[Rho]1", "2"], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Theta]2", "]"}], "2"]}]}]]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.9163114748345833`*^9, 3.916311852898614*^9, 
  3.9163824296590137`*^9, 3.916979292269546*^9, 3.9169793380771847`*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"92b5dd1d-1291-41b8-b15d-6eada467d5ca"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"For", " ", "julia"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"T", "/.", "subsol"}], " ", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Rho]1", "->", " ", 
        RowBox[{"k1", " ", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]1", "]"}], "/", "C1"}]}]}], ",", 
       RowBox[{"\[Rho]2", "->", " ", 
        RowBox[{"k2", " ", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]2", "]"}], "/", "C2"}]}]}]}], "}"}]}], 
    " ", "//", "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"%", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "k1", " ", 
        RowBox[{"(", 
         RowBox[{"x2", "-", "x1"}], ")"}]}]]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Theta]1", "->", "0"}], ",", 
       RowBox[{"\[Theta]2", "->", "0"}]}], "}"}]}], " ", "//", 
    "FullSimplify"}]}]}]], "Input",
 CellChangeTimes->{{3.9163115735325537`*^9, 3.916311684079542*^9}, {
  3.9163819903119593`*^9, 3.9163820323579607`*^9}, {3.916382138712728*^9, 
  3.916382178342121*^9}, {3.916382455244184*^9, 3.916382455708098*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"fa57b4ab-8700-426a-812d-7d22e665f9e6"],

Cell[BoxData[
 FractionBox[
  RowBox[{"4", " ", "C1", " ", "C2", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k1", " ", 
        RowBox[{"(", 
         RowBox[{"x1", "-", "x2"}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
       RowBox[{"k2", " ", 
        RowBox[{"(", 
         RowBox[{"x1", "+", "x2"}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], ")"}]}]]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["C1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x1", " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x2", " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]]}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox["C2", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x1", " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x2", " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]]}], ")"}]}], "+", 
   RowBox[{"2", " ", "C1", " ", "C2", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x1", " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x2", " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.916311625302472*^9, 3.916311687922065*^9}, 
   3.91631186514664*^9, {3.9163820128719797`*^9, 3.916382032936818*^9}, {
   3.916382172674266*^9, 3.9163821786813383`*^9}, {3.9163824325172873`*^9, 
   3.916382455928849*^9}, 3.9169792945538483`*^9, 3.916979359088944*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"a40f6309-5623-4495-a241-bc245d1675eb"],

Cell[BoxData[
 FractionBox[
  RowBox[{"4", " ", "C1", " ", "C2", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "k2", " ", 
     RowBox[{"(", 
      RowBox[{"x1", "+", "x2"}], ")"}]}]]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"C1", "+", "C2"}], ")"}], "2"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x1"}]]}], "-", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"C1", "-", "C2"}], ")"}], "2"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
     "2", " ", "\[ImaginaryI]", " ", "k2", " ", "x2"}]]}]}]]], "Output",
 CellChangeTimes->{{3.916311625302472*^9, 3.916311687922065*^9}, 
   3.91631186514664*^9, {3.9163820128719797`*^9, 3.916382032936818*^9}, {
   3.916382172674266*^9, 3.9163821786813383`*^9}, {3.9163824325172873`*^9, 
   3.916382455928849*^9}, 3.9169792945538483`*^9, 3.916979359090062*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"dcbc02b8-c450-447c-88f1-42d77fdfeb7d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"4", " ", "C1", " ", "C2", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "k2", " ", 
      RowBox[{"(", 
       RowBox[{"x1", "+", "x2"}], ")"}]}]], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "k2", " ", "x1"}]]}], 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"C1", "+", "C2"}], ")"}], "2"], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x1"}]], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "k2", " ", "x1"}]]}], 
    "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"C1", "-", "C2"}], ")"}], "2"], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x2"}]], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "k2", " ", "x1"}]]}]}]],
   "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.916382507581944*^9, 3.916382525413583*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"ddfbfa82-f116-4c7e-a778-31889c380ac4"],

Cell[BoxData[
 FractionBox[
  RowBox[{"4", " ", "C1", " ", "C2", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", "k2", " ", 
     RowBox[{"(", 
      RowBox[{"x1", "-", "x2"}], ")"}]}]]}], 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"C1", "+", "C2"}], ")"}], "2"], "-", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"C1", "-", "C2"}], ")"}], "2"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "k2", " ", 
      RowBox[{"(", 
       RowBox[{"x1", "-", "x2"}], ")"}]}]]}]}]]], "Output",
 CellChangeTimes->{3.916382525698091*^9, 3.9169792961830187`*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"3bb6f47a-0fc2-4758-b135-d5ef731fc276"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"T", "/.", "subsol"}], " ", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "->", "0"}], ",", 
     RowBox[{"\[Theta]2", "->", "0"}]}], "}"}]}], " ", "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Series", "[", 
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"x2", " ", "->", " ", 
      RowBox[{"x1", " ", "+", "d"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "0", ",", "1"}], "}"}]}], "]"}], " ", "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.916310757596171*^9, 3.916310803825959*^9}, {
   3.9163108371698017`*^9, 3.916310849889801*^9}, {3.9163109011375837`*^9, 
   3.916311027162562*^9}, {3.916311115609462*^9, 3.916311284904895*^9}, {
   3.9163113799386*^9, 3.916311394482524*^9}, {3.916311426640787*^9, 
   3.9163114316724854`*^9}, {3.916311501992298*^9, 3.916311513031917*^9}, 
   3.916311550328291*^9, {3.916311672007854*^9, 3.9163116771677237`*^9}, 
   3.9169794622556763`*^9},
 CellLabel->"In[44]:=",ExpressionUUID->"2f57086d-3898-4086-82cd-a2df5438364d"],

Cell[BoxData[
 FractionBox[
  RowBox[{"4", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k1", " ", 
        RowBox[{"(", 
         RowBox[{"x1", "-", "x2"}], ")"}]}], "+", 
       RowBox[{"k2", " ", 
        RowBox[{"(", 
         RowBox[{"x1", "+", "x2"}], ")"}]}]}], ")"}]}]], " ", "k1", " ", "k2",
    " ", "\[Rho]1", " ", "\[Rho]2"}], 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x2"}]]}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k2", " ", "\[Rho]1"}], "-", 
       RowBox[{"k1", " ", "\[Rho]2"}]}], ")"}], "2"]}], "+", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "k2", " ", "x1"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k2", " ", "\[Rho]1"}], "+", 
       RowBox[{"k1", " ", "\[Rho]2"}]}], ")"}], "2"]}]}]]], "Output",
 CellChangeTimes->{{3.916311237105019*^9, 3.916311276539239*^9}, {
   3.91631138089069*^9, 3.916311395524109*^9}, 3.916311431869031*^9, {
   3.91631148778719*^9, 3.91631151429007*^9}, 3.916311550522767*^9, {
   3.916311672280308*^9, 3.916311688956715*^9}, 3.916311865195397*^9, 
   3.916979297423603*^9, {3.916979455890686*^9, 3.9169794638942833`*^9}},
 CellLabel->"Out[44]=",ExpressionUUID->"ee90c3f0-41f2-497b-9b1a-c56a4b3e0128"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SuperscriptBox["k2", "2"], " ", "\[Rho]1"}], 
       RowBox[{"2", " ", "k1", " ", "\[Rho]2"}]], "+", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "k1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "\[Rho]1"}], "+", "\[Rho]2"}], ")"}]}], 
       RowBox[{"2", " ", "\[Rho]1"}]]}], ")"}], " ", "d"}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "d", "]"}], "2"],
    SeriesData[$CellContext`d, 0, {}, 0, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`d, 0, {1, Complex[0, 
       Rational[
       1, 2]] $CellContext`k1^(-1) $CellContext`k2^2 \
$CellContext`\[Rho]1/$CellContext`\[Rho]2 + Complex[0, 
       Rational[
       1, 2]] $CellContext`k1 $CellContext`\[Rho]1^(-1) ((-2) $CellContext`\
\[Rho]1 + $CellContext`\[Rho]2)}, 0, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.916311237105019*^9, 3.916311276539239*^9}, {
   3.91631138089069*^9, 3.916311395524109*^9}, 3.916311431869031*^9, {
   3.91631148778719*^9, 3.91631151429007*^9}, 3.916311550522767*^9, {
   3.916311672280308*^9, 3.916311688956715*^9}, 3.916311865195397*^9, 
   3.916979297423603*^9, {3.916979455890686*^9, 3.916979463909054*^9}},
 CellLabel->"Out[45]=",ExpressionUUID->"faf97621-e52d-46d6-8ec9-74656776e3b3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"T", " ", "=", " ", 
   RowBox[{
    FractionBox[
     RowBox[{"4", " ", "q", " ", "qs", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Zeta]1", " ", "-", " ", "\[Zeta]2"}], ")"}]}], " ", "+", 
        " ", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Zeta]1", " ", "+", " ", "\[Zeta]2"}], ")"}], " ", 
         RowBox[{"c", " ", "/", " ", "cs"}]}]}]]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"qs", "+", "q"}], ")"}], "2"], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Zeta]1", " ", 
         RowBox[{"c", "/", "cs"}]}]]}], "-", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"q", "-", "qs"}], ")"}], "2"], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", "\[ImaginaryI]", " ", "\[Zeta]2", " ", 
         RowBox[{"c", " ", "/", " ", "cs"}]}]]}]}]], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "\[Zeta]2"}]]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T", "/.", 
   RowBox[{"\[Zeta]2", "->", " ", 
    RowBox[{"d", " ", "+", " ", "\[Zeta]1"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Series", "[", 
   RowBox[{"%", ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "0", ",", "1"}], "}"}]}], "]"}], " ", "//", 
  "Simplify"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.916309097320614*^9, 3.916309128958205*^9}, {
  3.916309166916201*^9, 3.91630928924016*^9}, {3.9163103622758837`*^9, 
  3.916310362434783*^9}, {3.9163104315714693`*^9, 3.9163104395309353`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"1e0f5f1e-e6b5-4cb1-8547-d22264967da6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "\[Zeta]1"}]], "+", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "c", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Zeta]1"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q", "2"], "+", 
       SuperscriptBox["qs", "2"]}], ")"}], " ", "d"}], 
    RowBox[{"2", " ", "cs", " ", "q", " ", "qs"}]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "d", "]"}], "2"],
    SeriesData[$CellContext`d, 0, {}, 0, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`d, 0, {
   E^(Complex[0, 1] $CellContext`\[Zeta]1), Complex[0, 
      Rational[1, 2]] $CellContext`c $CellContext`cs^(-1) 
    E^(Complex[
       0, 1] $CellContext`\[Zeta]1) $CellContext`q^(-1) $CellContext`qs^(-1) \
($CellContext`q^2 + $CellContext`qs^2)}, 0, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.916309267980402*^9, 3.916309289418202*^9}, 
   3.916310362969253*^9, {3.916310431824629*^9, 3.9163104442411203`*^9}},
 CellLabel->"Out[18]=",ExpressionUUID->"e811459d-cd1f-4826-97ac-1c2cb268777d"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440, 762},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"13.3 for Linux x86 (64-bit) (June 3, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"ec8f41f7-53e2-40ba-8f40-226433cfd18b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 189, 3, 54, "Subsection",ExpressionUUID->"fc2d53ca-f1df-4305-9756-5a2ef579fb84"],
Cell[CellGroupData[{
Cell[794, 29, 4141, 122, 362, "Input",ExpressionUUID->"505ed892-b0ee-4b93-bf20-789175b2a272"],
Cell[4938, 153, 434, 7, 33, "Output",ExpressionUUID->"fc2f5679-1c2b-49fa-882b-1731f835a4da"],
Cell[5375, 162, 1032, 25, 58, "Output",ExpressionUUID->"fbf24fc6-1eef-40cf-8680-2c99a27abd01"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6444, 192, 1162, 30, 92, "Input",ExpressionUUID->"5fa6d3ee-515e-4d4f-b620-3b3d999753b5"],
Cell[7609, 224, 279, 4, 33, "Output",ExpressionUUID->"3cb4d945-6e85-4b2c-9d5a-f43d2f9542d4"],
Cell[7891, 230, 277, 4, 33, "Output",ExpressionUUID->"3bb59479-0d48-4621-9aaa-1626fcf721a3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8205, 239, 297, 7, 71, "Subsubsection",ExpressionUUID->"d1cb2ce3-807f-4d39-b7c9-8c9054dbea11"],
Cell[CellGroupData[{
Cell[8527, 250, 1504, 43, 78, "Input",ExpressionUUID->"54e62f58-fdf6-4b56-9122-ce13eef202da"],
Cell[10034, 295, 683, 18, 64, "Output",ExpressionUUID->"76976d20-2cfb-47b0-b25a-51817d64923f"]
}, Open  ]],
Cell[10732, 316, 384, 9, 58, "Input",ExpressionUUID->"0028ab2b-a57b-4f16-ae70-6bbe3d5fc8e7"],
Cell[11119, 327, 1202, 30, 70, "Input",ExpressionUUID->"f518e691-2764-48d5-93d6-9b4a69e0aebd"],
Cell[CellGroupData[{
Cell[12346, 361, 6335, 186, 621, "Input",ExpressionUUID->"55751fef-0974-4177-ba5a-bc71fb3567d7"],
Cell[18684, 549, 289, 5, 33, "Output",ExpressionUUID->"d23a16fe-8428-427c-93eb-78158897f762"],
Cell[18976, 556, 10858, 248, 248, "Output",ExpressionUUID->"92b5dd1d-1291-41b8-b15d-6eada467d5ca"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29871, 809, 1289, 34, 74, "Input",ExpressionUUID->"fa57b4ab-8700-426a-812d-7d22e665f9e6"],
Cell[31163, 845, 2160, 49, 65, "Output",ExpressionUUID->"a40f6309-5623-4495-a241-bc245d1675eb"],
Cell[33326, 896, 1042, 25, 60, "Output",ExpressionUUID->"dcbc02b8-c450-447c-88f1-42d77fdfeb7d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34405, 926, 1271, 33, 57, "Input",ExpressionUUID->"ddfbfa82-f116-4c7e-a778-31889c380ac4"],
Cell[35679, 961, 785, 22, 60, "Output",ExpressionUUID->"3bb6f47a-0fc2-4758-b135-d5ef731fc276"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36501, 988, 1073, 25, 52, "Input",ExpressionUUID->"2f57086d-3898-4086-82cd-a2df5438364d"],
Cell[37577, 1015, 1461, 37, 62, "Output",ExpressionUUID->"ee90c3f0-41f2-497b-9b1a-c56a4b3e0128"],
Cell[39041, 1054, 1465, 35, 60, "Output",ExpressionUUID->"faf97621-e52d-46d6-8ec9-74656776e3b3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40543, 1094, 1837, 48, 121, "Input",ExpressionUUID->"1e0f5f1e-e6b5-4cb1-8547-d22264967da6"],
Cell[42383, 1144, 1182, 28, 61, "Output",ExpressionUUID->"e811459d-cd1f-4826-97ac-1c2cb268777d"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

